{"config":{"lang":["pt"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#plataformas-microsservicos-e-apis","title":"Plataformas, Microsservi\u00e7os e APIs","text":"<p>Bem-vindo \u00e0 documenta\u00e7\u00e3o do curso de Plataformas, Microsservi\u00e7os e APIs.</p>"},{"location":"#conteudo","title":"Conte\u00fado","text":"<ul> <li>This documentation - Instru\u00e7\u00f5es sobre como configurar e usar esta documenta\u00e7\u00e3o</li> <li>Roteiros pr\u00e1ticos</li> <li>Projeto final</li> </ul>"},{"location":"#comecando","title":"Come\u00e7ando","text":"<p>Para come\u00e7ar, consulte a se\u00e7\u00e3o This documentation para instru\u00e7\u00f5es sobre como configurar seu ambiente de desenvolvimento.</p>"},{"location":"notebook1/ex1_data/","title":"Notebook 1","text":""},{"location":"notebook1/ex1_data/#notebook-1","title":"Notebook 1","text":"<p>Conte\u00fado do Notebook 1 ser\u00e1 adicionado aqui.</p>"},{"location":"projeto/main/","title":"Projeto","text":""},{"location":"projeto/main/#projeto","title":"Projeto","text":"<p>Informa\u00e7\u00f5es sobre o projeto final ser\u00e3o adicionadas aqui.</p>"},{"location":"roteiro%205/main/","title":"Minikube - Kubernetes Local","text":""},{"location":"roteiro%205/main/#minikube-kubernetes-local","title":"Minikube - Kubernetes Local","text":""},{"location":"roteiro%205/main/#objetivo","title":"Objetivo","text":"<p>Este guia descreve como executar todos os microservi\u00e7os em um cluster Kubernetes local usando o Minikube, simulando um ambiente de orquestra\u00e7\u00e3o completo em sua m\u00e1quina de desenvolvimento. O projeto \u00e9 composto por 6 microservi\u00e7os (Gateway, Product, Order, Account, Auth e Exchange), al\u00e9m de servi\u00e7os de infraestrutura (PostgreSQL e Redis), todos containerizados e orquestrados via Kubernetes.</p>"},{"location":"roteiro%205/main/#pre-requisitos","title":"Pr\u00e9-Requisitos","text":"<p>Antes de iniciar, certifique-se de ter as seguintes ferramentas instaladas:</p> <ul> <li>\u2705 Docker instalado e em execu\u00e7\u00e3o (vers\u00e3o &gt;= 20.10)</li> <li>\u2705 Minikube instalado (vers\u00e3o &gt;= 1.0)</li> <li>\u2705 kubectl instalado e configurado</li> <li>\u2705 Privil\u00e9gios de sudo (caso necess\u00e1rio para funcionalidades espec\u00edficas)</li> <li>\u2705 Pelo menos 4GB de RAM dispon\u00edvel para o Minikube</li> <li>\u2705 Pelo menos 20GB de espa\u00e7o em disco</li> </ul>"},{"location":"roteiro%205/main/#instalacao-das-ferramentas","title":"Instala\u00e7\u00e3o das Ferramentas","text":""},{"location":"roteiro%205/main/#docker","title":"Docker","text":"<pre><code># macOS (Homebrew)\nbrew install --cask docker\n\n# Linux\ncurl -fsSL https://get.docker.com | sh\n</code></pre>"},{"location":"roteiro%205/main/#minikube","title":"Minikube","text":"<pre><code># macOS (Homebrew)\nbrew install minikube\n\n# Linux\ncurl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\nsudo install minikube-linux-amd64 /usr/local/bin/minikube\n</code></pre>"},{"location":"roteiro%205/main/#kubectl","title":"kubectl","text":"<pre><code># macOS (Homebrew)\nbrew install kubectl\n\n# Linux\ncurl -LO \"https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl\"\nsudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl\n</code></pre>"},{"location":"roteiro%205/main/#passos-para-iniciar","title":"Passos para Iniciar","text":""},{"location":"roteiro%205/main/#1-iniciar-o-minikube","title":"1. Iniciar o Minikube","text":"<p>No terminal, execute:</p> <pre><code>minikube start --driver=docker --memory=4096 --cpus=2\n</code></pre> <p>Par\u00e2metros: - <code>--driver=docker</code>: Utiliza o Docker como driver (tamb\u00e9m pode usar <code>virtualbox</code>, <code>hyperkit</code>, etc.) - <code>--memory=4096</code>: Aloca 4GB de RAM para o cluster - <code>--cpus=2</code>: Aloca 2 CPUs para o cluster</p> <p>Aguarde at\u00e9 que o Minikube fa\u00e7a o download da imagem base, inicie o cluster e configure o ambiente.</p> <p>Sa\u00edda esperada: </p><pre><code>\ud83d\ude04  minikube v1.x.x on Darwin 13.x\n\u2728  Using the docker driver based on user configuration\n\ud83d\udc4d  Starting control plane node minikube in cluster minikube\n\ud83d\ude9c  Pulling base image ...\n\ud83d\udd25  Creating docker container (CPUs=2, Memory=4096MB) ...\n\ud83d\udc33  Preparing Kubernetes v1.28.x on Docker 24.0.x ...\n\ud83d\udd0e  Verifying Kubernetes components...\n\ud83c\udf1f  Enabled addons: storage-provisioner, default-storageclass\n\ud83c\udfc4  Done! kubectl is now configured to use \"minikube\" cluster\n</code></pre><p></p>"},{"location":"roteiro%205/main/#2-clonar-e-navegar-ate-o-projeto","title":"2. Clonar e Navegar at\u00e9 o Projeto","text":"<pre><code># Clonar o reposit\u00f3rio (se ainda n\u00e3o tiver feito)\ngit clone https://github.com/seu-usuario/pma.2025.2.git\ncd pma.2025.2\n</code></pre>"},{"location":"roteiro%205/main/#3-criar-recursos-de-infraestrutura","title":"3. Criar Recursos de Infraestrutura","text":"<p>Antes de deployar os microservi\u00e7os, precisamos criar os recursos compartilhados: ConfigMaps, Secrets, PostgreSQL e Redis.</p>"},{"location":"roteiro%205/main/#31-criar-configmap-do-postgresql","title":"3.1. Criar ConfigMap do PostgreSQL","text":"<p>Crie o arquivo <code>k8s/postgres-configmap.yaml</code>:</p> <pre><code>apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: postgres-configmap\ndata:\n  POSTGRES_DB: store\n</code></pre> <p>Aplique: </p><pre><code>kubectl apply -f k8s/postgres-configmap.yaml\n</code></pre><p></p>"},{"location":"roteiro%205/main/#32-criar-secrets-do-postgresql","title":"3.2. Criar Secrets do PostgreSQL","text":"<p>Crie o arquivo <code>k8s/postgres-secrets.yaml</code>:</p> <pre><code>apiVersion: v1\nkind: Secret\nmetadata:\n  name: postgres-secrets\ntype: Opaque\ndata:\n  POSTGRES_USER: c3RvcmU=        # base64: store\n  POSTGRES_PASSWORD: c3RvcmU=    # base64: store\n</code></pre> <p>Nota: Para gerar seu pr\u00f3prio base64: </p><pre><code>echo -n \"store\" | base64\n</code></pre><p></p> <p>Aplique: </p><pre><code>kubectl apply -f k8s/postgres-secrets.yaml\n</code></pre><p></p>"},{"location":"roteiro%205/main/#33-deployar-postgresql","title":"3.3. Deployar PostgreSQL","text":"<p>Crie o arquivo <code>k8s/postgres-deployment.yaml</code>:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: postgres\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: postgres\n  template:\n    metadata:\n      labels:\n        app: postgres\n    spec:\n      containers:\n        - name: postgres\n          image: postgres:17.6\n          ports:\n            - containerPort: 5432\n          env:\n            - name: POSTGRES_DB\n              valueFrom:\n                configMapKeyRef:\n                  name: postgres-configmap\n                  key: POSTGRES_DB\n            - name: POSTGRES_USER\n              valueFrom:\n                secretKeyRef:\n                  name: postgres-secrets\n                  key: POSTGRES_USER\n            - name: POSTGRES_PASSWORD\n              valueFrom:\n                secretKeyRef:\n                  name: postgres-secrets\n                  key: POSTGRES_PASSWORD\n          volumeMounts:\n            - name: postgres-storage\n              mountPath: /var/lib/postgresql/data\n          resources:\n            requests:\n              memory: \"256Mi\"\n              cpu: \"100m\"\n            limits:\n              memory: \"512Mi\"\n              cpu: \"500m\"\n      volumes:\n        - name: postgres-storage\n          emptyDir: {}\n\n---\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: postgres\n  labels:\n    app: postgres\nspec:\n  type: ClusterIP\n  ports:\n    - port: 5432\n      protocol: TCP\n      targetPort: 5432\n  selector:\n    app: postgres\n</code></pre> <p>Aplique: </p><pre><code>kubectl apply -f k8s/postgres-deployment.yaml\n</code></pre><p></p>"},{"location":"roteiro%205/main/#34-deployar-redis","title":"3.4. Deployar Redis","text":"<p>Crie o arquivo <code>k8s/redis-deployment.yaml</code>:</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: redis\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: redis\n  template:\n    metadata:\n      labels:\n        app: redis\n    spec:\n      containers:\n        - name: redis\n          image: redis:7-alpine\n          ports:\n            - containerPort: 6379\n          resources:\n            requests:\n              memory: \"128Mi\"\n              cpu: \"50m\"\n            limits:\n              memory: \"256Mi\"\n              cpu: \"200m\"\n\n---\n\napiVersion: v1\nkind: Service\nmetadata:\n  name: redis\n  labels:\n    app: redis\nspec:\n  type: ClusterIP\n  ports:\n    - port: 6379\n      protocol: TCP\n      targetPort: 6379\n  selector:\n    app: redis\n</code></pre> <p>Aplique: </p><pre><code>kubectl apply -f k8s/redis-deployment.yaml\n</code></pre><p></p>"},{"location":"roteiro%205/main/#4-deployar-os-microservicos","title":"4. Deployar os Microservi\u00e7os","text":"<p>Agora vamos deployar todos os microservi\u00e7os. Voc\u00ea pode fazer isso individualmente ou de uma vez.</p>"},{"location":"roteiro%205/main/#opcao-1-deploy-individual","title":"Op\u00e7\u00e3o 1: Deploy Individual","text":"<pre><code># Gateway Service\nkubectl apply -f api/gateway-service/k8s/k8s.yaml\n\n# Product Service\nkubectl apply -f api/product_service/k8s/k8s.yaml\n\n# Order Service\nkubectl apply -f api/order_service/k8s/k8s.yaml\n\n# Account Service\nkubectl apply -f api/accountservice/k8s/k8s.yaml\n\n# Auth Service\nkubectl apply -f api/auth_service/k8s/k8s.yaml\n\n# Exchange Service\nkubectl apply -f api/exchange/k8s/k8s.yaml\n</code></pre>"},{"location":"roteiro%205/main/#opcao-2-deploy-em-lote-recomendado","title":"Op\u00e7\u00e3o 2: Deploy em Lote (Recomendado)","text":"<p>Crie um diret\u00f3rio <code>k8s/services/</code> e copie todos os manifests:</p> <pre><code>mkdir -p k8s/services\ncp api/gateway-service/k8s/k8s.yaml k8s/services/gateway.yaml\ncp api/product_service/k8s/k8s.yaml k8s/services/product.yaml\ncp api/order_service/k8s/k8s.yaml k8s/services/order.yaml\ncp api/accountservice/k8s/k8s.yaml k8s/services/account.yaml\ncp api/auth_service/k8s/k8s.yaml k8s/services/auth.yaml\ncp api/exchange/k8s/k8s.yaml k8s/services/exchange.yaml\n</code></pre> <p>Aplique todos de uma vez: </p><pre><code>kubectl apply -f k8s/services/\n</code></pre><p></p>"},{"location":"roteiro%205/main/#5-verificar-status","title":"5. Verificar Status","text":""},{"location":"roteiro%205/main/#51-verificar-pods","title":"5.1. Verificar Pods","text":"<pre><code>kubectl get pods\n</code></pre> <p>Sa\u00edda esperada:</p> <pre><code>NAME                                READY   STATUS    RESTARTS   AGE\npostgres-XXXXXXXXXX-XXXXX           1/1     Running   0          5m\nredis-XXXXXXXXXX-XXXXX              1/1     Running   0          5m\ngateway-XXXXXXXXXX-XXXXX            1/1     Running   0          2m\nproduct-service-XXXXXXXXXX-XXXXX    1/1     Running   0          2m\norder-service-XXXXXXXXXX-XXXXX      1/1     Running   0          2m\naccount-service-XXXXXXXXXX-XXXXX    1/1     Running   0          2m\nauth-service-XXXXXXXXXX-XXXXX       1/1     Running   0          2m\nexchange-service-XXXXXXXXXX-XXXXX   1/1     Running   0          2m\n</code></pre> <p></p> <p>Verificar se todos os pods est\u00e3o com o STATUS <code>Running</code> e <code>READY 1/1</code>.</p> <p>Caso algum pod esteja com status <code>CrashLoopBackOff</code> ou <code>Error</code>, inspecione os logs:</p> <pre><code>kubectl logs &lt;nome-do-pod&gt;\n\n# Exemplo:\nkubectl logs product-service-XXXXXXXXXX-XXXXX\n</code></pre>"},{"location":"roteiro%205/main/#52-verificar-servicos","title":"5.2. Verificar Servi\u00e7os","text":"<pre><code>kubectl get svc\n</code></pre> <p>Sa\u00edda esperada:</p> <pre><code>NAME               TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE\nkubernetes         ClusterIP   10.96.0.1       &lt;none&gt;        443/TCP    10m\npostgres           ClusterIP   10.96.0.10      &lt;none&gt;        5432/TCP   5m\nredis              ClusterIP   10.96.0.11      &lt;none&gt;        6379/TCP   5m\ngateway            ClusterIP   10.96.0.12      &lt;none&gt;        80/TCP     2m\nproduct-service    ClusterIP   10.96.0.13      &lt;none&gt;        80/TCP     2m\norder-service      ClusterIP   10.96.0.14      &lt;none&gt;        80/TCP     2m\naccount-service    ClusterIP   10.96.0.15      &lt;none&gt;        80/TCP     2m\nauth-service       ClusterIP   10.96.0.16      &lt;none&gt;        80/TCP     2m\nexchange-service   ClusterIP   10.96.0.17      &lt;none&gt;        80/TCP     2m\n</code></pre> <p></p>"},{"location":"roteiro%205/main/#acessando-a-aplicacao","title":"Acessando a Aplica\u00e7\u00e3o","text":""},{"location":"roteiro%205/main/#6-expor-o-gateway-para-acesso-externo","title":"6. Expor o Gateway para Acesso Externo","text":"<p>O Gateway \u00e9 o ponto de entrada da aplica\u00e7\u00e3o. Para acess\u00e1-lo externamente, use o comando <code>minikube service</code>:</p> <pre><code>minikube service gateway\n</code></pre> <p>O Minikube criar\u00e1 automaticamente um t\u00fanel tempor\u00e1rio e abrir\u00e1 o servi\u00e7o no navegador. Caso n\u00e3o abra automaticamente, ser\u00e1 exibido o URL:</p> <pre><code>|-----------|---------|-------------|---------------------------|\n| NAMESPACE |  NAME   | TARGET PORT |            URL            |\n|-----------|---------|-------------|---------------------------|\n| default   | gateway |          80 | http://192.168.49.2:30080 |\n|-----------|---------|-------------|---------------------------|\n\ud83c\udf89  Opening service default/gateway in default browser...\n</code></pre>"},{"location":"roteiro%205/main/#61-alternativa-port-forward","title":"6.1. Alternativa: Port Forward","text":"<p>Se preferir usar port forwarding:</p> <pre><code>kubectl port-forward svc/gateway 8080:80\n</code></pre> <p>Acesse: <code>http://localhost:8080</code></p>"},{"location":"roteiro%205/main/#62-alternativa-minikube-tunnel-loadbalancer","title":"6.2. Alternativa: Minikube Tunnel (LoadBalancer)","text":"<p>Para usar servi\u00e7os do tipo <code>LoadBalancer</code>, abra um novo terminal e execute:</p> <pre><code>minikube tunnel\n</code></pre> <p>Isso criar\u00e1 um t\u00fanel que exp\u00f5e servi\u00e7os LoadBalancer no <code>localhost</code>.</p>"},{"location":"roteiro%205/main/#estrutura-do-diretorio-k8s","title":"Estrutura do Diret\u00f3rio k8s/","text":"<pre><code>\ud83d\udcc1 k8s/\n\u251c\u2500\u2500 \ud83d\udcc4 postgres-configmap.yaml       # ConfigMap do PostgreSQL\n\u251c\u2500\u2500 \ud83d\udcc4 postgres-secrets.yaml         # Secrets do PostgreSQL\n\u251c\u2500\u2500 \ud83d\udcc4 postgres-deployment.yaml      # Deployment e Service do PostgreSQL\n\u251c\u2500\u2500 \ud83d\udcc4 redis-deployment.yaml         # Deployment e Service do Redis\n\u251c\u2500\u2500 \ud83d\udcc1 services/\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 gateway.yaml              # Gateway Service (porta 80)\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 product.yaml              # Product Service (porta 80)\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 order.yaml                # Order Service (porta 80)\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 account.yaml              # Account Service (porta 80)\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 auth.yaml                 # Auth Service (porta 80)\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 exchange.yaml             # Exchange Service (porta 80)\n\u2514\u2500\u2500 \ud83d\udcc4 README.md                     # Este arquivo\n</code></pre>"},{"location":"roteiro%205/main/#microservicos-deployados","title":"Microservi\u00e7os Deployados","text":""},{"location":"roteiro%205/main/#1-gateway-service","title":"1. Gateway Service","text":"<ul> <li>Imagem: <code>deenaelorra/gateway:latest</code></li> <li>Porta: 8080 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: PostgreSQL, Redis</li> <li>Recursos: 200Mi-300Mi RAM, 50m-200m CPU</li> </ul>"},{"location":"roteiro%205/main/#2-product-service","title":"2. Product Service","text":"<ul> <li>Imagem: <code>deenaelorra/product:latest</code></li> <li>Porta: 8080 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: PostgreSQL, Redis</li> <li>Recursos: 200Mi-300Mi RAM, 50m-200m CPU</li> <li>Schema: <code>product</code> (Flyway auto-migration)</li> </ul>"},{"location":"roteiro%205/main/#3-order-service","title":"3. Order Service","text":"<ul> <li>Imagem: <code>deenaelorra/order:latest</code></li> <li>Porta: 8080 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: PostgreSQL, Redis</li> <li>Recursos: 200Mi-300Mi RAM, 50m-200m CPU</li> </ul>"},{"location":"roteiro%205/main/#4-account-service","title":"4. Account Service","text":"<ul> <li>Imagem: <code>deenaelorra/account:latest</code></li> <li>Porta: 8080 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: PostgreSQL, Redis</li> <li>Recursos: 200Mi-300Mi RAM, 50m-200m CPU</li> </ul>"},{"location":"roteiro%205/main/#5-auth-service","title":"5. Auth Service","text":"<ul> <li>Imagem: <code>deenaelorra/auth:latest</code></li> <li>Porta: 8080 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: PostgreSQL, Redis</li> <li>Recursos: 200Mi-300Mi RAM, 50m-200m CPU</li> <li>JWT: Issuer: <code>store-auth</code>, Expiration: 1 hora</li> </ul>"},{"location":"roteiro%205/main/#6-exchange-service","title":"6. Exchange Service","text":"<ul> <li>Imagem: <code>deenaelorra/exchange:latest</code></li> <li>Porta: 8000 (container) \u2192 80 (service)</li> <li>Tipo: ClusterIP</li> <li>Depend\u00eancias: Nenhuma (Python/FastAPI)</li> <li>Recursos: 100Mi-200Mi RAM, 50m-200m CPU</li> </ul>"},{"location":"roteiro%205/main/#infraestrutura","title":"Infraestrutura","text":""},{"location":"roteiro%205/main/#postgresql","title":"PostgreSQL","text":"<ul> <li>Imagem: <code>postgres:17.6</code></li> <li>Porta: 5432</li> <li>Database: <code>store</code></li> <li>User: <code>store</code> (configurado via Secret)</li> <li>Password: <code>store</code> (configurado via Secret)</li> <li>Recursos: 256Mi-512Mi RAM, 100m-500m CPU</li> </ul>"},{"location":"roteiro%205/main/#redis","title":"Redis","text":"<ul> <li>Imagem: <code>redis:7-alpine</code></li> <li>Porta: 6379</li> <li>Recursos: 128Mi-256Mi RAM, 50m-200m CPU</li> </ul>"},{"location":"roteiro%205/main/#arquitetura-de-comunicacao","title":"Arquitetura de Comunica\u00e7\u00e3o","text":"<pre><code>                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502   Cliente/User   \u2502\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n                                   v\n                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502     Gateway      \u2502 :80\n                          \u2502   (API Gateway)  \u2502\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                                   \u2502\n          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n          \u2502            \u2502           \u2502           \u2502            \u2502\n          v            v           v           v            v\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Product \u2502  \u2502  Order  \u2502  \u2502 Account \u2502  \u2502  Auth   \u2502  \u2502Exchange \u2502\n    \u2502 Service \u2502  \u2502 Service \u2502  \u2502 Service \u2502  \u2502 Service \u2502  \u2502 Service \u2502\n    \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502            \u2502            \u2502            \u2502\n         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                      \u2502            \u2502\n                      v            v\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502  PostgreSQL  \u2502  \u2502  Redis   \u2502\n              \u2502   Database   \u2502  \u2502  Cache   \u2502\n              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"roteiro%205/main/#comandos-uteis","title":"Comandos \u00dateis","text":""},{"location":"roteiro%205/main/#gerenciar-cluster-minikube","title":"Gerenciar Cluster Minikube","text":"<pre><code># Ver status do Minikube\nminikube status\n\n# Parar o Minikube\nminikube stop\n\n# Deletar o cluster\nminikube delete\n\n# Acessar dashboard do Kubernetes\nminikube dashboard\n\n# Ver IP do Minikube\nminikube ip\n\n# SSH no node do Minikube\nminikube ssh\n</code></pre>"},{"location":"roteiro%205/main/#gerenciar-recursos-kubernetes","title":"Gerenciar Recursos Kubernetes","text":"<pre><code># Listar todos os recursos\nkubectl get all\n\n# Descrever um pod\nkubectl describe pod &lt;nome-do-pod&gt;\n\n# Ver logs de um pod\nkubectl logs &lt;nome-do-pod&gt;\n\n# Ver logs em tempo real\nkubectl logs -f &lt;nome-do-pod&gt;\n\n# Executar comando em um pod\nkubectl exec -it &lt;nome-do-pod&gt; -- /bin/bash\n\n# Deletar um pod\nkubectl delete pod &lt;nome-do-pod&gt;\n\n# Deletar todos os recursos\nkubectl delete -f k8s/services/\n\n# Escalar um deployment\nkubectl scale deployment gateway --replicas=3\n\n# Ver eventos do cluster\nkubectl get events --sort-by=.metadata.creationTimestamp\n</code></pre>"},{"location":"roteiro%205/main/#gerenciar-imagens-no-minikube","title":"Gerenciar Imagens no Minikube","text":"<pre><code># Usar Docker do Minikube (evita pull do Docker Hub)\neval $(minikube docker-env)\n\n# Voltar ao Docker local\neval $(minikube docker-env -u)\n\n# Listar imagens no Minikube\nminikube ssh docker images\n\n# Carregar imagem local no Minikube\nminikube image load deenaelorra/gateway:latest\n</code></pre>"},{"location":"roteiro%205/main/#troubleshooting","title":"Troubleshooting","text":""},{"location":"roteiro%205/main/#problema-pods-nao-iniciam-imagepullbackoff","title":"Problema: Pods n\u00e3o iniciam (ImagePullBackOff)","text":"<p>Causa: Minikube n\u00e3o consegue baixar a imagem do Docker Hub</p> <p>Solu\u00e7\u00e3o 1: Use o Docker do Minikube para buildar localmente </p><pre><code>eval $(minikube docker-env)\ndocker build -t deenaelorra/gateway:latest api/gateway-service/\n</code></pre><p></p> <p>Solu\u00e7\u00e3o 2: Altere <code>imagePullPolicy</code> para <code>IfNotPresent</code> ou <code>Never</code> </p><pre><code>imagePullPolicy: IfNotPresent\n</code></pre><p></p>"},{"location":"roteiro%205/main/#problema-pods-reiniciando-crashloopbackoff","title":"Problema: Pods reiniciando (CrashLoopBackOff)","text":"<p>Causa: Aplica\u00e7\u00e3o falhando ao iniciar</p> <p>Solu\u00e7\u00e3o: Verifique os logs </p><pre><code>kubectl logs &lt;nome-do-pod&gt;\nkubectl describe pod &lt;nome-do-pod&gt;\n</code></pre><p></p> <p>Poss\u00edveis causas: - PostgreSQL n\u00e3o est\u00e1 pronto - Credenciais inv\u00e1lidas - Porta j\u00e1 em uso - Falta de mem\u00f3ria</p>"},{"location":"roteiro%205/main/#problema-nao-consigo-acessar-o-servico","title":"Problema: N\u00e3o consigo acessar o servi\u00e7o","text":"<p>Solu\u00e7\u00e3o: Verifique se o servi\u00e7o est\u00e1 rodando </p><pre><code>kubectl get svc\nminikube service gateway --url\n</code></pre><p></p> <p>Use port-forward como alternativa: </p><pre><code>kubectl port-forward svc/gateway 8080:80\n</code></pre><p></p>"},{"location":"roteiro%205/main/#problema-postgresql-nao-esta-acessivel","title":"Problema: PostgreSQL n\u00e3o est\u00e1 acess\u00edvel","text":"<p>Solu\u00e7\u00e3o: Verifique se o pod est\u00e1 rodando </p><pre><code>kubectl get pods | grep postgres\nkubectl logs &lt;postgres-pod&gt;\n</code></pre><p></p> <p>Teste a conex\u00e3o: </p><pre><code>kubectl exec -it &lt;postgres-pod&gt; -- psql -U store -d store\n</code></pre><p></p>"},{"location":"roteiro%205/main/#problema-minikube-lento","title":"Problema: Minikube lento","text":"<p>Solu\u00e7\u00e3o: Aumente recursos </p><pre><code>minikube stop\nminikube delete\nminikube start --driver=docker --memory=8192 --cpus=4\n</code></pre><p></p>"},{"location":"roteiro%205/main/#screenshots","title":"Screenshots","text":""},{"location":"roteiro%205/main/#dashboard-do-kubernetes","title":"Dashboard do Kubernetes","text":""},{"location":"roteiro%205/main/#pods-em-execucao","title":"Pods em Execu\u00e7\u00e3o","text":""},{"location":"roteiro%205/main/#servicos-ativos","title":"Servi\u00e7os Ativos","text":""},{"location":"roteiro%205/main/#logs-de-um-pod","title":"Logs de um Pod","text":""},{"location":"roteiro%205/main/#deploy-dos-microsservicos-em-kubernetes","title":"Deploy dos Microsservi\u00e7os em Kubernetes","text":""},{"location":"roteiro%205/main/#resumo-dos-manifests","title":"Resumo dos Manifests","text":"Servi\u00e7o Arquivo Replicas Imagem Porta Depend\u00eancias Gateway api/gateway-service/k8s/k8s.yaml 1 deenaelorra/gateway:latest 8080\u219280 PostgreSQL, Redis Product api/product_service/k8s/k8s.yaml 1 deenaelorra/product:latest 8080\u219280 PostgreSQL, Redis Order api/order_service/k8s/k8s.yaml 1 deenaelorra/order:latest 8080\u219280 PostgreSQL, Redis Account api/accountservice/k8s/k8s.yaml 1 deenaelorra/account:latest 8080\u219280 PostgreSQL, Redis Auth api/auth_service/k8s/k8s.yaml 1 deenaelorra/auth:latest 8080\u219280 PostgreSQL, Redis Exchange api/exchange/k8s/k8s.yaml 1 deenaelorra/exchange:latest 8000\u219280 Nenhuma"},{"location":"roteiro%205/main/#repositorios","title":"Reposit\u00f3rios","text":"Componente Descri\u00e7\u00e3o Link do Reposit\u00f3rio Gateway Service API Gateway para roteamento [Link do reposit\u00f3rio] Product Service Gerenciamento de produtos [Link do reposit\u00f3rio] Order Service Gerenciamento de pedidos [Link do reposit\u00f3rio] Account Service Gerenciamento de contas [Link do reposit\u00f3rio] Auth Service Autentica\u00e7\u00e3o e JWT [Link do reposit\u00f3rio] Exchange Service Taxas de c\u00e2mbio (Python) [Link do reposit\u00f3rio]"},{"location":"roteiro%205/main/#tecnologias-utilizadas","title":"Tecnologias Utilizadas","text":"<ul> <li>Minikube - Kubernetes local</li> <li>kubectl - CLI do Kubernetes</li> <li>Docker - Containeriza\u00e7\u00e3o</li> <li>PostgreSQL 17.6 - Banco de dados relacional</li> <li>Redis 7 - Cache em mem\u00f3ria</li> <li>Spring Boot 3.5.5 - Framework Java</li> <li>FastAPI 0.104.1 - Framework Python</li> </ul>"},{"location":"roteiro%205/main/#melhorias-futuras","title":"Melhorias Futuras","text":"<ol> <li>Helm Charts: Simplificar deploy com Helm</li> <li>Horizontal Pod Autoscaler: Escalonamento autom\u00e1tico</li> <li>Ingress Controller: Roteamento avan\u00e7ado</li> <li>Persistent Volumes: Armazenamento persistente para PostgreSQL</li> <li>Monitoring: Prometheus e Grafana</li> <li>Logging: ELK Stack ou Loki</li> <li>Service Mesh: Istio para observabilidade</li> </ol>"},{"location":"roteiro%205/main/#licenca","title":"Licen\u00e7a","text":"<p>[Adicione informa\u00e7\u00f5es sobre a licen\u00e7a do projeto]</p>"},{"location":"roteiro%205/main/#contato","title":"Contato","text":"<p>[Adicione informa\u00e7\u00f5es de contato ou contribui\u00e7\u00e3o]</p>"},{"location":"roteiro1/main/","title":"Roteiro 1","text":""},{"location":"roteiro1/main/#product-api-documentacao","title":"Product API - Documenta\u00e7\u00e3o","text":""},{"location":"roteiro1/main/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>A Product API \u00e9 uma API RESTful de CRUD (Create, Read, Update, Delete) desenvolvida em Spring Boot para gerenciamento de produtos. O projeto segue uma arquitetura de microservi\u00e7os, onde o Product atua como um FeignClient que comunica com o Product Service, respons\u00e1vel pela l\u00f3gica de neg\u00f3cios e persist\u00eancia de dados em PostgreSQL. A API permite criar, listar, buscar e deletar produtos atrav\u00e9s de endpoints HTTP, utilizando DTOs (ProductIn/ProductOut) para contratos de API e suportando recursos como caching com Redis e migra\u00e7\u00f5es de banco de dados com Flyway.</p>"},{"location":"roteiro1/main/#endpoints-principais","title":"Endpoints Principais","text":""},{"location":"roteiro1/main/#1-criar-produto","title":"1. Criar Produto","text":"<p>Endpoint: <code>POST /product</code></p> <p>Descri\u00e7\u00e3o: Cria um novo produto no sistema.</p> <p>Request Body: </p><pre><code>{\n  \"name\": \"Arroz Integral\",\n  \"price\": 12.50,\n  \"unit\": \"kg\"\n}\n</code></pre><p></p> <p>Response (201 Created): </p><pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"Arroz Integral\",\n  \"price\": 12.50,\n  \"unit\": \"kg\"\n}\n</code></pre><p></p>"},{"location":"roteiro1/main/#2-listar-todos-os-produtos","title":"2. Listar Todos os Produtos","text":"<p>Endpoint: <code>GET /product</code></p> <p>Descri\u00e7\u00e3o: Retorna a lista de todos os produtos cadastrados.</p> <p>Response (200 OK): </p><pre><code>[\n  {\n    \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"name\": \"Arroz Integral\",\n    \"price\": 12.50,\n    \"unit\": \"kg\"\n  },\n  {\n    \"id\": \"660e8400-e29b-41d4-a716-446655440001\",\n    \"name\": \"Feij\u00e3o Preto\",\n    \"price\": 8.90,\n    \"unit\": \"kg\"\n  }\n]\n</code></pre><p></p>"},{"location":"roteiro1/main/#3-buscar-produto-por-id","title":"3. Buscar Produto por ID","text":"<p>Endpoint: <code>GET /product/{id}</code></p> <p>Descri\u00e7\u00e3o: Retorna os detalhes de um produto espec\u00edfico.</p> <p>Exemplo: <code>GET /product/550e8400-e29b-41d4-a716-446655440000</code></p> <p>Response (200 OK): </p><pre><code>{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"name\": \"Arroz Integral\",\n  \"price\": 12.50,\n  \"unit\": \"kg\"\n}\n</code></pre><p></p>"},{"location":"roteiro1/main/#4-deletar-produto","title":"4. Deletar Produto","text":"<p>Endpoint: <code>DELETE /product/{id}</code></p> <p>Descri\u00e7\u00e3o: Remove um produto do sistema.</p> <p>Exemplo: <code>DELETE /product/550e8400-e29b-41d4-a716-446655440000</code></p> <p>Response (204 No Content)</p>"},{"location":"roteiro1/main/#testes-com-postman","title":"Testes com Postman","text":""},{"location":"roteiro1/main/#criar-produto","title":"Criar Produto","text":""},{"location":"roteiro1/main/#listar-produtos","title":"Listar Produtos","text":""},{"location":"roteiro1/main/#buscar-produto-por-id","title":"Buscar Produto por ID","text":""},{"location":"roteiro1/main/#deletar-produto","title":"Deletar Produto","text":""},{"location":"roteiro1/main/#estrutura-do-projeto","title":"Estrutura do Projeto","text":""},{"location":"roteiro1/main/#product-api-feignclient","title":"Product API (FeignClient)","text":"<pre><code>\ud83d\udcc1 api/\n\u2514\u2500\u2500 \ud83d\udcc1 product/\n    \u251c\u2500\u2500 \ud83d\udcc1 src/\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc1 main/\n    \u2502       \u2514\u2500\u2500 \ud83d\udcc1 java/\n    \u2502           \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502               \u2514\u2500\u2500 \ud83d\udcc1 product/\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 ProductController.java\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 ProductIn.java\n    \u2502                   \u2514\u2500\u2500 \ud83d\udcc4 ProductOut.java\n    \u251c\u2500\u2500 \ud83d\udcc4 pom.xml\n    \u2514\u2500\u2500 \ud83d\udcc4 README.md\n</code></pre>"},{"location":"roteiro1/main/#product-service-api","title":"Product Service API","text":"<pre><code>\ud83d\udcc1 api/\n\u2514\u2500\u2500 \ud83d\udcc1 product_service/\n    \u251c\u2500\u2500 \ud83d\udcc1 src/\n    \u2502   \u251c\u2500\u2500 \ud83d\udcc1 main/\n    \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 java/\n    \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 product/\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 ProductApplication.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 ProductResource.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 ProductService.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 Product.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 ProductModel.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 ProductRepository.java\n    \u2502   \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc4 ProductParser.java\n    \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 resources/\n    \u2502   \u2502       \u251c\u2500\u2500 \ud83d\udcc4 application.yaml\n    \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 db/\n    \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc1 migration/\n    \u2502   \u2502               \u251c\u2500\u2500 \ud83d\udcc4 V2025.10.27.001__create_schema.sql\n    \u2502   \u2502               \u2514\u2500\u2500 \ud83d\udcc4 V2025.10.27.002__create_table_product.sql\n    \u2502   \u251c\u2500\u2500 \ud83d\udcc1 test/\n    \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 java/\n    \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 product/\n    \u2502   \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc4 ProductResourceTest.java\n    \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 resources/\n    \u2502   \u2502       \u251c\u2500\u2500 \ud83d\udcc4 application-test.yaml\n    \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 db/\n    \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc1 migration/\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc1 k8s/\n    \u2502       \u2514\u2500\u2500 \ud83d\udcc4 k8s.yaml\n    \u2514\u2500\u2500 \ud83d\udcc4 pom.xml\n</code></pre>"},{"location":"roteiro1/main/#repositorios","title":"Reposit\u00f3rios","text":"Componente Descri\u00e7\u00e3o Link do Reposit\u00f3rio Product API FeignClient para comunica\u00e7\u00e3o entre microservi\u00e7os [https://github.com/DeenaElOrra/product] Product Service Servi\u00e7o principal com l\u00f3gica de neg\u00f3cios e persist\u00eancia [https://github.com/DeenaElOrra/product_service] Gateway API Gateway para roteamento de requisi\u00e7\u00f5es [https://github.com/DeenaElOrra/gateway-service]"},{"location":"roteiro1/main/#configuracao-e-execucao","title":"Configura\u00e7\u00e3o e Execu\u00e7\u00e3o","text":""},{"location":"roteiro1/main/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<ul> <li>Java 21+</li> <li>Maven 3.8+</li> <li>PostgreSQL 14+</li> <li>Redis (opcional, para caching)</li> </ul>"},{"location":"roteiro1/main/#variaveis-de-ambiente-product-service","title":"Vari\u00e1veis de Ambiente (Product Service)","text":"<pre><code>DATABASE_HOST=localhost\nDATABASE_PORT=5432\nDATABASE_USER=store\nDATABASE_PASSWORD=store\n</code></pre>"},{"location":"roteiro1/main/#executar-product-service","title":"Executar Product Service","text":"<pre><code>cd api/product_service\nmvn clean install\nmvn spring-boot:run\n</code></pre> <p>A aplica\u00e7\u00e3o estar\u00e1 dispon\u00edvel em: <code>http://localhost:8080</code></p>"},{"location":"roteiro1/main/#schema-do-banco-de-dados","title":"Schema do Banco de Dados","text":"<pre><code>CREATE SCHEMA IF NOT EXISTS product;\n\nCREATE TABLE product.product (\n    id varchar(36) NOT NULL,\n    name varchar(255) NOT NULL,\n    price decimal(10,2) NOT NULL,\n    unit varchar(20) NOT NULL,\n    CONSTRAINT product_primary_key PRIMARY KEY (id)\n);\n</code></pre>"},{"location":"roteiro1/main/#testes","title":"Testes","text":""},{"location":"roteiro1/main/#executar-testes-de-integracao","title":"Executar Testes de Integra\u00e7\u00e3o","text":"<pre><code>cd api/product_service\nmvn test\n</code></pre> <p>Os testes utilizam TestContainers para subir uma inst\u00e2ncia PostgreSQL em container Docker.</p>"},{"location":"roteiro2/main/","title":"Roteiro 2","text":""},{"location":"roteiro2/main/#exchange-api-documentacao","title":"Exchange API - Documenta\u00e7\u00e3o","text":""},{"location":"roteiro2/main/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>A Exchange API \u00e9 uma API RESTful desenvolvida em Python com FastAPI para gerenciamento de taxas de c\u00e2mbio em tempo real. A API integra-se com o servi\u00e7o externo Awesome API para obter cota\u00e7\u00f5es atualizadas de moedas e aplica um spread de 1.5% para c\u00e1lculo das taxas de compra e venda. O servi\u00e7o \u00e9 protegido por autentica\u00e7\u00e3o JWT atrav\u00e9s do API Gateway e requer um ID de conta v\u00e1lido em cada requisi\u00e7\u00e3o. A API suporta opera\u00e7\u00f5es ass\u00edncronas para melhor performance e \u00e9 totalmente containerizada com Docker e Kubernetes.</p>"},{"location":"roteiro2/main/#endpoints-principais","title":"Endpoints Principais","text":""},{"location":"roteiro2/main/#1-obter-taxa-de-cambio","title":"1. Obter Taxa de C\u00e2mbio","text":"<p>Endpoint: <code>GET /exchange/{from_currency}/{to_currency}</code></p> <p>Descri\u00e7\u00e3o: Retorna as taxas de compra e venda entre duas moedas.</p> <p>Headers Obrigat\u00f3rios: </p><pre><code>Authorization: Bearer {jwt_token}\nid-account: {account_id}\n</code></pre><p></p> <p>Par\u00e2metros de Path: - <code>from_currency</code>: C\u00f3digo da moeda de origem (3 letras, ex: USD, BRL, EUR) - <code>to_currency</code>: C\u00f3digo da moeda de destino (3 letras, ex: USD, BRL, EUR)</p> <p>Exemplo: <code>GET /exchange/USD/BRL</code></p> <p>Response (200 OK): </p><pre><code>{\n  \"buy\": 5.2575,\n  \"sell\": 5.1825,\n  \"timestamp\": \"2025-10-31 14:30:45\",\n  \"account_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"base_rate\": 5.22\n}\n</code></pre><p></p> <p>Campos da Resposta: - <code>buy</code>: Taxa de compra com spread de 1.5% aplicado - <code>sell</code>: Taxa de venda com spread de 1.5% aplicado - <code>timestamp</code>: Data e hora da transa\u00e7\u00e3o - <code>account_id</code>: ID da conta do usu\u00e1rio autenticado - <code>base_rate</code>: Taxa base sem spread (obtida da API externa)</p> <p>C\u00f3digos de Status: - <code>200 OK</code>: Taxa de c\u00e2mbio retornada com sucesso - <code>400 Bad Request</code>: C\u00f3digos de moeda inv\u00e1lidos ou par n\u00e3o suportado - <code>401 Unauthorized</code>: Account ID ausente ou inv\u00e1lido - <code>503 Service Unavailable</code>: API externa indispon\u00edvel - <code>504 Gateway Timeout</code>: Timeout ao chamar API externa - <code>500 Internal Server Error</code>: Erro interno do servidor</p>"},{"location":"roteiro2/main/#2-health-check","title":"2. Health Check","text":"<p>Endpoint: <code>GET /health</code></p> <p>Descri\u00e7\u00e3o: Verifica o status de sa\u00fade do servi\u00e7o.</p> <p>Autentica\u00e7\u00e3o: N\u00e3o requerida</p> <p>Response (200 OK): </p><pre><code>{\n  \"status\": \"healthy\",\n  \"service\": \"exchange-api\",\n  \"timestamp\": \"2025-10-31T14:30:45.123456\"\n}\n</code></pre><p></p>"},{"location":"roteiro2/main/#3-informacoes-da-api","title":"3. Informa\u00e7\u00f5es da API","text":"<p>Endpoint: <code>GET /</code></p> <p>Descri\u00e7\u00e3o: Retorna informa\u00e7\u00f5es sobre a API e seus endpoints dispon\u00edveis.</p> <p>Autentica\u00e7\u00e3o: N\u00e3o requerida</p> <p>Response (200 OK): </p><pre><code>{\n  \"service\": \"Currency Exchange API\",\n  \"version\": \"1.0.0\",\n  \"endpoints\": {\n    \"exchange\": \"/exchange/{from}/{to}\",\n    \"health\": \"/health\",\n    \"docs\": \"/docs\"\n  }\n}\n</code></pre><p></p>"},{"location":"roteiro2/main/#testes-com-postman","title":"Testes com Postman","text":""},{"location":"roteiro2/main/#obter-taxa-de-cambio-usd-para-brl","title":"Obter Taxa de C\u00e2mbio (USD para BRL)","text":""},{"location":"roteiro2/main/#obter-taxa-de-cambio-eur-para-brl","title":"Obter Taxa de C\u00e2mbio (EUR para BRL)","text":""},{"location":"roteiro2/main/#health-check","title":"Health Check","text":""},{"location":"roteiro2/main/#erro-moeda-invalida","title":"Erro - Moeda Inv\u00e1lida","text":""},{"location":"roteiro2/main/#estrutura-do-projeto","title":"Estrutura do Projeto","text":""},{"location":"roteiro2/main/#exchange-api-fastapi","title":"Exchange API (FastAPI)","text":"<pre><code>\ud83d\udcc1 api/\n\u2514\u2500\u2500 \ud83d\udcc1 exchange/\n    \u251c\u2500\u2500 \ud83d\udcc1 app/\n    \u2502   \u251c\u2500\u2500 \ud83d\udcc4 main.py\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc4 requirements.txt\n    \u251c\u2500\u2500 \ud83d\udcc1 k8s/\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc4 k8s.yaml\n    \u251c\u2500\u2500 \ud83d\udcc4 Dockerfile\n    \u251c\u2500\u2500 \ud83d\udcc4 README.md\n    \u2514\u2500\u2500 \ud83d\udcc1 .git/\n</code></pre>"},{"location":"roteiro2/main/#detalhamento-dos-arquivos","title":"Detalhamento dos Arquivos","text":"<p>main.py - Aplica\u00e7\u00e3o FastAPI principal contendo: - <code>ExchangeRateResponse</code>: Modelo de resposta (Pydantic) - <code>ExchangeRateService</code>: Servi\u00e7o de l\u00f3gica de neg\u00f3cios - Rotas e endpoints REST - Valida\u00e7\u00f5es de entrada - Tratamento de erros</p> <p>requirements.txt - Depend\u00eancias Python: - <code>fastapi==0.104.1</code> - Framework web - <code>uvicorn[standard]==0.24.0</code> - Servidor ASGI - <code>httpx==0.25.1</code> - Cliente HTTP ass\u00edncrono - <code>pydantic==2.5.0</code> - Valida\u00e7\u00e3o de dados</p> <p>Dockerfile - Containeriza\u00e7\u00e3o da aplica\u00e7\u00e3o: - Base: <code>python:3.11-slim</code> - Porta exposta: 8000 - Comando: <code>uvicorn app.main:app --host 0.0.0.0 --port 8000</code></p> <p>k8s.yaml - Configura\u00e7\u00e3o Kubernetes: - Deployment com 1 r\u00e9plica - Service ClusterIP na porta 80 - Recursos: 100Mi-200Mi RAM, 50m-200m CPU</p>"},{"location":"roteiro2/main/#repositorios","title":"Reposit\u00f3rios","text":"Componente Descri\u00e7\u00e3o Link do Reposit\u00f3rio Exchange API API de taxas de c\u00e2mbio em tempo real (FastAPI) [Link do reposit\u00f3rio] Gateway Service API Gateway para roteamento e autentica\u00e7\u00e3o [Link do reposit\u00f3rio]"},{"location":"roteiro2/main/#tecnologias-utilizadas","title":"Tecnologias Utilizadas","text":"<ul> <li>FastAPI 0.104.1 - Framework web moderno e de alta performance</li> <li>Python 3.11 - Linguagem de programa\u00e7\u00e3o</li> <li>Uvicorn - Servidor ASGI de alto desempenho</li> <li>Httpx 0.25.1 - Cliente HTTP ass\u00edncrono para chamadas externas</li> <li>Pydantic 2.5.0 - Valida\u00e7\u00e3o de dados e serializa\u00e7\u00e3o</li> <li>Docker - Containeriza\u00e7\u00e3o da aplica\u00e7\u00e3o</li> <li>Kubernetes - Orquestra\u00e7\u00e3o de containers</li> </ul>"},{"location":"roteiro2/main/#configuracao-e-execucao","title":"Configura\u00e7\u00e3o e Execu\u00e7\u00e3o","text":""},{"location":"roteiro2/main/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<ul> <li>Python 3.11+</li> <li>Docker (opcional, para containeriza\u00e7\u00e3o)</li> <li>Kubernetes (opcional, para deploy em cluster)</li> </ul>"},{"location":"roteiro2/main/#executar-localmente-sem-docker","title":"Executar Localmente (sem Docker)","text":"<pre><code>cd api/exchange\npip install -r app/requirements.txt\nuvicorn app.main:app --reload --host 0.0.0.0 --port 8000\n</code></pre> <p>A aplica\u00e7\u00e3o estar\u00e1 dispon\u00edvel em: <code>http://localhost:8000</code></p>"},{"location":"roteiro2/main/#executar-com-docker","title":"Executar com Docker","text":"<pre><code>cd api/exchange\ndocker build -t exchange-api .\ndocker run -p 8000:8000 exchange-api\n</code></pre>"},{"location":"roteiro2/main/#deploy-no-kubernetes","title":"Deploy no Kubernetes","text":"<pre><code>cd api/exchange\nkubectl apply -f k8s/k8s.yaml\n</code></pre> <p>O servi\u00e7o estar\u00e1 dispon\u00edvel internamente no cluster em: <code>http://exchange:80</code></p>"},{"location":"roteiro2/main/#integracao-com-api-externa","title":"Integra\u00e7\u00e3o com API Externa","text":""},{"location":"roteiro2/main/#awesome-api-economia","title":"Awesome API - Economia","text":"<ul> <li>URL Base: <code>https://economia.awesomeapi.com.br/json/last</code></li> <li>Formato de Requisi\u00e7\u00e3o: <code>GET /{FROM_CURRENCY}-{TO_CURRENCY}</code></li> <li>Exemplo: <code>https://economia.awesomeapi.com.br/json/last/USD-BRL</code></li> <li>Timeout: 10 segundos</li> <li>Taxa Utilizada: Campo <code>bid</code> da resposta (taxa de compra)</li> </ul>"},{"location":"roteiro2/main/#calculo-de-spread","title":"C\u00e1lculo de Spread","text":"<p>A API aplica um spread de 1.5% sobre a taxa base:</p> <pre><code>SPREAD_PERCENTAGE = 0.015\n\nbuy_rate = base_rate * (1 + SPREAD_PERCENTAGE)   # +1.5%\nsell_rate = base_rate * (1 - SPREAD_PERCENTAGE)  # -1.5%\n</code></pre> <p>Exemplo: - Taxa base: 5.22 - Taxa de compra: 5.22 \u00d7 1.015 = 5.2575 - Taxa de venda: 5.22 \u00d7 0.985 = 5.1825</p>"},{"location":"roteiro2/main/#autenticacao-e-seguranca","title":"Autentica\u00e7\u00e3o e Seguran\u00e7a","text":""},{"location":"roteiro2/main/#fluxo-de-autenticacao","title":"Fluxo de Autentica\u00e7\u00e3o","text":"<ol> <li> <p>Cliente envia requisi\u00e7\u00e3o para o Gateway:    </p><pre><code>GET /exchange/USD/BRL\nAuthorization: Bearer {jwt_token}\n</code></pre><p></p> </li> <li> <p>Gateway (AuthorizationFilter) valida o token:</p> </li> <li>Extrai o token JWT do header <code>Authorization</code></li> <li>Valida o formato (<code>Bearer {token}</code>)</li> <li> <p>Chama o Auth Service para validar o token</p> </li> <li> <p>Auth Service retorna o Account ID:    </p><pre><code>{ \"idAccount\": \"550e8400-e29b-41d4-a716-446655440000\" }\n</code></pre><p></p> </li> <li> <p>Gateway adiciona header e encaminha:    </p><pre><code>GET /exchange/USD/BRL\nid-account: 550e8400-e29b-41d4-a716-446655440000\n</code></pre><p></p> </li> <li> <p>Exchange API valida e processa:</p> </li> <li>Valida presen\u00e7a do header <code>id-account</code></li> <li>Valida c\u00f3digos de moeda</li> <li>Busca taxa de c\u00e2mbio</li> <li>Retorna resposta com dados do usu\u00e1rio</li> </ol>"},{"location":"roteiro2/main/#endpoints-publicos-sem-autenticacao","title":"Endpoints P\u00fablicos (sem autentica\u00e7\u00e3o)","text":"<ul> <li><code>GET /health</code> - Health check</li> <li><code>GET /</code> - Informa\u00e7\u00f5es da API</li> <li><code>GET /docs</code> - Documenta\u00e7\u00e3o interativa (Swagger)</li> </ul>"},{"location":"roteiro2/main/#validacoes","title":"Valida\u00e7\u00f5es","text":""},{"location":"roteiro2/main/#validacao-de-account-id","title":"Valida\u00e7\u00e3o de Account ID","text":"<pre><code>def validate_account_id(account_id: Optional[str]) -&gt; str:\n    if not account_id or account_id.strip() == \"\":\n        raise HTTPException(\n            status_code=401,\n            detail=\"Account ID is required\"\n        )\n    return account_id\n</code></pre>"},{"location":"roteiro2/main/#validacao-de-codigo-de-moeda","title":"Valida\u00e7\u00e3o de C\u00f3digo de Moeda","text":"<pre><code>def validate_currency_code(currency: str) -&gt; str:\n    if not currency or len(currency) != 3 or not currency.isalpha():\n        raise HTTPException(\n            status_code=400,\n            detail=f\"Invalid currency code: {currency}\"\n        )\n    return currency.upper()\n</code></pre>"},{"location":"roteiro2/main/#tratamento-de-erros","title":"Tratamento de Erros","text":"Erro Status Code Descri\u00e7\u00e3o Account ID ausente 401 Header <code>id-account</code> n\u00e3o encontrado C\u00f3digo de moeda inv\u00e1lido 400 C\u00f3digo n\u00e3o tem 3 letras ou n\u00e3o \u00e9 alfab\u00e9tico Moedas id\u00eanticas 400 <code>from_currency</code> igual a <code>to_currency</code> Par n\u00e3o suportado 400 API externa n\u00e3o suporta o par de moedas Timeout API externa 504 Tempo limite de 10s excedido API externa indispon\u00edvel 503 Erro HTTP da API externa Erro interno 500 Exce\u00e7\u00e3o n\u00e3o tratada"},{"location":"roteiro2/main/#arquitetura-de-microservicos","title":"Arquitetura de Microservi\u00e7os","text":""},{"location":"roteiro2/main/#comunicacao-com-gateway","title":"Comunica\u00e7\u00e3o com Gateway","text":"<pre><code>Cliente\n  |\n  v\n[Gateway Service - Spring Cloud Gateway] :8080\n  |\n  \u251c\u2500\u2500 Valida JWT token\n  \u251c\u2500\u2500 Extrai Account ID do Auth Service\n  \u251c\u2500\u2500 Adiciona header: id-account\n  |\n  v\n[Exchange Service - FastAPI] :80\n  |\n  \u251c\u2500\u2500 Valida Account ID\n  \u251c\u2500\u2500 Valida c\u00f3digos de moeda\n  \u251c\u2500\u2500 Chama API Externa (Awesome API)\n  \u251c\u2500\u2500 Aplica spread de 1.5%\n  \u2514\u2500\u2500 Retorna taxas de compra/venda\n</code></pre>"},{"location":"roteiro2/main/#configuracao-de-rota-no-gateway","title":"Configura\u00e7\u00e3o de Rota no Gateway","text":"<p>Arquivo: <code>api/gateway-service/src/main/resources/application.yaml</code></p> <pre><code>spring:\n  cloud:\n    gateway:\n      routes:\n        - id: exchange\n          uri: http://exchange:80\n          predicates:\n            - Path=/exchange/**\n</code></pre>"},{"location":"roteiro2/main/#documentacao-interativa","title":"Documenta\u00e7\u00e3o Interativa","text":"<p>A API fornece documenta\u00e7\u00e3o interativa gerada automaticamente pelo FastAPI:</p> <ul> <li>Swagger UI: <code>http://localhost:8000/docs</code></li> <li>ReDoc: <code>http://localhost:8000/redoc</code></li> </ul> <p>Essas interfaces permitem testar os endpoints diretamente no navegador.</p>"},{"location":"roteiro2/main/#logging","title":"Logging","text":"<p>A aplica\u00e7\u00e3o utiliza o m\u00f3dulo <code>logging</code> do Python para registrar eventos:</p> <pre><code>import logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n</code></pre> <p>Eventos logados: - Requisi\u00e7\u00f5es recebidas - Chamadas \u00e0 API externa - Erros e exce\u00e7\u00f5es - Timeouts e falhas de comunica\u00e7\u00e3o</p>"},{"location":"roteiro2/main/#recursos-do-kubernetes","title":"Recursos do Kubernetes","text":""},{"location":"roteiro2/main/#deployment","title":"Deployment","text":"<ul> <li>Replicas: 1</li> <li>Image: <code>deenaelorra/exchange:latest</code></li> <li>Container Port: 8000</li> <li>Resources:</li> <li>Requests: 100Mi RAM, 50m CPU</li> <li>Limits: 200Mi RAM, 200m CPU</li> </ul>"},{"location":"roteiro2/main/#service","title":"Service","text":"<ul> <li>Type: ClusterIP (acesso interno ao cluster)</li> <li>Port: 80 (externo) \u2192 8000 (container)</li> <li>Selector: <code>app: exchange</code></li> </ul>"},{"location":"roteiro2/main/#exemplos-de-uso","title":"Exemplos de Uso","text":""},{"location":"roteiro2/main/#obter-taxa-usd-para-brl","title":"Obter Taxa USD para BRL","text":"<p>Request: </p><pre><code>curl -X GET \"http://localhost:8000/exchange/USD/BRL\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\" \\\n  -H \"id-account: 550e8400-e29b-41d4-a716-446655440000\"\n</code></pre><p></p> <p>Response: </p><pre><code>{\n  \"buy\": 5.2575,\n  \"sell\": 5.1825,\n  \"timestamp\": \"2025-10-31 14:30:45\",\n  \"account_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"base_rate\": 5.22\n}\n</code></pre><p></p>"},{"location":"roteiro2/main/#obter-taxa-eur-para-usd","title":"Obter Taxa EUR para USD","text":"<p>Request: </p><pre><code>curl -X GET \"http://localhost:8000/exchange/EUR/USD\" \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\" \\\n  -H \"id-account: 550e8400-e29b-41d4-a716-446655440000\"\n</code></pre><p></p> <p>Response: </p><pre><code>{\n  \"buy\": 1.0959,\n  \"sell\": 1.0791,\n  \"timestamp\": \"2025-10-31 14:32:10\",\n  \"account_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"base_rate\": 1.0875\n}\n</code></pre><p></p>"},{"location":"roteiro2/main/#monitoramento","title":"Monitoramento","text":""},{"location":"roteiro2/main/#health-check-endpoint","title":"Health Check Endpoint","text":"<p>O endpoint <code>/health</code> pode ser usado para: - Liveness Probe no Kubernetes - Readiness Probe no Kubernetes - Monitoramento externo (uptime checks)</p> <p>Exemplo de Liveness Probe: </p><pre><code>livenessProbe:\n  httpGet:\n    path: /health\n    port: 8000\n  initialDelaySeconds: 10\n  periodSeconds: 30\n</code></pre><p></p>"},{"location":"roteiro2/main/#moedas-suportadas","title":"Moedas Suportadas","text":"<p>A API suporta qualquer par de moedas dispon\u00edvel na Awesome API, incluindo:</p>"},{"location":"roteiro2/main/#principais-moedas","title":"Principais Moedas","text":"<ul> <li>USD - D\u00f3lar Americano</li> <li>BRL - Real Brasileiro</li> <li>EUR - Euro</li> <li>GBP - Libra Esterlina</li> <li>JPY - Iene Japon\u00eas</li> <li>AUD - D\u00f3lar Australiano</li> <li>CAD - D\u00f3lar Canadense</li> <li>CHF - Franco Su\u00ed\u00e7o</li> <li>ARS - Peso Argentino</li> <li>BTC - Bitcoin</li> </ul> <p>Para ver a lista completa de moedas suportadas, consulte: https://docs.awesomeapi.com.br</p>"},{"location":"roteiro2/main/#limitacoes-e-consideracoes","title":"Limita\u00e7\u00f5es e Considera\u00e7\u00f5es","text":"<ol> <li>Rate Limiting: A API externa pode ter limites de requisi\u00e7\u00f5es</li> <li>Disponibilidade: Dependente da disponibilidade da Awesome API</li> <li>Timeout: Requisi\u00e7\u00f5es com mais de 10 segundos s\u00e3o canceladas</li> <li>Autentica\u00e7\u00e3o Obrigat\u00f3ria: Todos os endpoints de c\u00e2mbio requerem autentica\u00e7\u00e3o</li> <li>Spread Fixo: O spread de 1.5% \u00e9 fixo e n\u00e3o configur\u00e1vel via API</li> </ol>"},{"location":"roteiro2/main/#licenca","title":"Licen\u00e7a","text":"<p>[Adicione informa\u00e7\u00f5es sobre a licen\u00e7a do projeto]</p>"},{"location":"roteiro2/main/#contato","title":"Contato","text":"<p>[Adicione informa\u00e7\u00f5es de contato ou contribui\u00e7\u00e3o]</p>"},{"location":"roteiro3/main/","title":"Roteiro 3","text":""},{"location":"roteiro3/main/#order-api-documentacao","title":"Order API - Documenta\u00e7\u00e3o","text":""},{"location":"roteiro3/main/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>A Order API \u00e9 uma API RESTful de CRUD (Create, Read, Update, Delete) desenvolvida em Spring Boot para gerenciamento de pedidos em um sistema de e-commerce. O projeto segue uma arquitetura de microservi\u00e7os, onde o Order atua como um FeignClient que comunica com o Order Service, respons\u00e1vel pela l\u00f3gica de neg\u00f3cios e persist\u00eancia de dados em PostgreSQL. A API permite criar, listar, buscar e deletar pedidos atrav\u00e9s de endpoints HTTP, integrando-se com o Product Service para enriquecer os itens do pedido com informa\u00e7\u00f5es de produto em tempo real. O servi\u00e7o suporta multi-tenancy baseado em headers (id-account), utiliza migra\u00e7\u00f5es de banco de dados com Flyway, e implementa relacionamentos cascata entre pedidos e itens.</p>"},{"location":"roteiro3/main/#endpoints-principais","title":"Endpoints Principais","text":""},{"location":"roteiro3/main/#1-criar-pedido","title":"1. Criar Pedido","text":"<p>Endpoint: <code>POST /order</code></p> <p>Descri\u00e7\u00e3o: Cria um novo pedido com seus itens. Automaticamente busca informa\u00e7\u00f5es dos produtos e calcula totais.</p> <p>Headers Obrigat\u00f3rios: </p><pre><code>id-account: {account_id}\n</code></pre><p></p> <p>Request Body: </p><pre><code>{\n  \"items\": [\n    {\n      \"idProduct\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"quantity\": 2\n    },\n    {\n      \"idProduct\": \"660e8400-e29b-41d4-a716-446655440001\",\n      \"quantity\": 5\n    }\n  ]\n}\n</code></pre><p></p> <p>Response (201 Created): </p><pre><code>{\n  \"id\": \"770e8400-e29b-41d4-a716-446655440002\",\n  \"idAccount\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"date\": \"2025-10-31T14:30:45\",\n  \"items\": [\n    {\n      \"id\": \"880e8400-e29b-41d4-a716-446655440003\",\n      \"product\": {\n        \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"name\": \"Arroz Integral\",\n        \"price\": 12.50,\n        \"unit\": \"kg\"\n      },\n      \"quantity\": 2,\n      \"subtotal\": 25.00\n    },\n    {\n      \"id\": \"990e8400-e29b-41d4-a716-446655440004\",\n      \"product\": {\n        \"id\": \"660e8400-e29b-41d4-a716-446655440001\",\n        \"name\": \"Feij\u00e3o Preto\",\n        \"price\": 8.90,\n        \"unit\": \"kg\"\n      },\n      \"quantity\": 5,\n      \"subtotal\": 44.50\n    }\n  ],\n  \"total\": 69.50\n}\n</code></pre><p></p>"},{"location":"roteiro3/main/#2-listar-todos-os-pedidos","title":"2. Listar Todos os Pedidos","text":"<p>Endpoint: <code>GET /order</code></p> <p>Descri\u00e7\u00e3o: Retorna todos os pedidos da conta autenticada.</p> <p>Headers Obrigat\u00f3rios: </p><pre><code>id-account: {account_id}\n</code></pre><p></p> <p>Response (200 OK): </p><pre><code>[\n  {\n    \"id\": \"770e8400-e29b-41d4-a716-446655440002\",\n    \"idAccount\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"date\": \"2025-10-31T14:30:45\",\n    \"items\": [\n      {\n        \"id\": \"880e8400-e29b-41d4-a716-446655440003\",\n        \"product\": {\n          \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n          \"name\": \"Arroz Integral\",\n          \"price\": 12.50,\n          \"unit\": \"kg\"\n        },\n        \"quantity\": 2,\n        \"subtotal\": 25.00\n      }\n    ],\n    \"total\": 25.00\n  }\n]\n</code></pre><p></p>"},{"location":"roteiro3/main/#3-buscar-pedido-por-id","title":"3. Buscar Pedido por ID","text":"<p>Endpoint: <code>GET /order/{id}</code></p> <p>Descri\u00e7\u00e3o: Retorna os detalhes de um pedido espec\u00edfico.</p> <p>Headers Obrigat\u00f3rios: </p><pre><code>id-account: {account_id}\n</code></pre><p></p> <p>Exemplo: <code>GET /order/770e8400-e29b-41d4-a716-446655440002</code></p> <p>Response (200 OK): </p><pre><code>{\n  \"id\": \"770e8400-e29b-41d4-a716-446655440002\",\n  \"idAccount\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"date\": \"2025-10-31T14:30:45\",\n  \"items\": [\n    {\n      \"id\": \"880e8400-e29b-41d4-a716-446655440003\",\n      \"product\": {\n        \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"name\": \"Arroz Integral\",\n        \"price\": 12.50,\n        \"unit\": \"kg\"\n      },\n      \"quantity\": 2,\n      \"subtotal\": 25.00\n    }\n  ],\n  \"total\": 25.00\n}\n</code></pre><p></p> <p>C\u00f3digos de Status: - <code>200 OK</code>: Pedido encontrado - <code>404 Not Found</code>: Pedido n\u00e3o encontrado ou n\u00e3o pertence \u00e0 conta</p>"},{"location":"roteiro3/main/#4-deletar-pedido","title":"4. Deletar Pedido","text":"<p>Endpoint: <code>DELETE /order/{id}</code></p> <p>Descri\u00e7\u00e3o: Remove um pedido e todos os seus itens (cascade delete).</p> <p>Headers Obrigat\u00f3rios: </p><pre><code>id-account: {account_id}\n</code></pre><p></p> <p>Exemplo: <code>DELETE /order/770e8400-e29b-41d4-a716-446655440002</code></p> <p>Response (204 No Content)</p> <p>C\u00f3digos de Status: - <code>204 No Content</code>: Pedido deletado com sucesso - <code>404 Not Found</code>: Pedido n\u00e3o encontrado ou n\u00e3o pertence \u00e0 conta</p>"},{"location":"roteiro3/main/#testes-com-postman","title":"Testes com Postman","text":""},{"location":"roteiro3/main/#criar-pedido","title":"Criar Pedido","text":""},{"location":"roteiro3/main/#listar-pedidos","title":"Listar Pedidos","text":""},{"location":"roteiro3/main/#buscar-pedido-por-id","title":"Buscar Pedido por ID","text":""},{"location":"roteiro3/main/#deletar-pedido","title":"Deletar Pedido","text":""},{"location":"roteiro3/main/#estrutura-do-projeto","title":"Estrutura do Projeto","text":""},{"location":"roteiro3/main/#order-api-feignclient","title":"Order API (FeignClient)","text":"<pre><code>\ud83d\udcc1 api/\n\u2514\u2500\u2500 \ud83d\udcc1 order/\n    \u251c\u2500\u2500 \ud83d\udcc1 src/\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc1 main/\n    \u2502       \u2514\u2500\u2500 \ud83d\udcc1 java/\n    \u2502           \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502               \u2514\u2500\u2500 \ud83d\udcc1 order/\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 OrderController.java\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 OrderIn.java\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 OrderOut.java\n    \u2502                   \u251c\u2500\u2500 \ud83d\udcc4 OrderItemIn.java\n    \u2502                   \u2514\u2500\u2500 \ud83d\udcc4 OrderItemOut.java\n    \u251c\u2500\u2500 \ud83d\udcc4 pom.xml\n    \u2514\u2500\u2500 \ud83d\udcc4 README.md\n</code></pre>"},{"location":"roteiro3/main/#order-service-api","title":"Order Service API","text":"<pre><code>\ud83d\udcc1 api/\n\u2514\u2500\u2500 \ud83d\udcc1 order_service/\n    \u251c\u2500\u2500 \ud83d\udcc1 src/\n    \u2502   \u251c\u2500\u2500 \ud83d\udcc1 main/\n    \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 java/\n    \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 order/\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderApplication.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderResource.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderService.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderParser.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 Order.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderItem.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderModel.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderItemModel.java\n    \u2502   \u2502   \u2502           \u251c\u2500\u2500 \ud83d\udcc4 OrderRepository.java\n    \u2502   \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc4 OrderItemRepository.java\n    \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc1 resources/\n    \u2502   \u2502       \u251c\u2500\u2500 \ud83d\udcc4 application.yaml\n    \u2502   \u2502       \u2514\u2500\u2500 \ud83d\udcc1 db/\n    \u2502   \u2502           \u2514\u2500\u2500 \ud83d\udcc1 migration/\n    \u2502   \u2502               \u251c\u2500\u2500 \ud83d\udcc4 V2025.10.27.001__create_schema.sql\n    \u2502   \u2502               \u251c\u2500\u2500 \ud83d\udcc4 V2025.10.27.002__create_table_order.sql\n    \u2502   \u2502               \u2514\u2500\u2500 \ud83d\udcc4 V2025.10.27.003__create_table_order_item.sql\n    \u2502   \u2514\u2500\u2500 \ud83d\udcc1 test/\n    \u2502       \u2514\u2500\u2500 \ud83d\udcc1 java/\n    \u2502           \u2514\u2500\u2500 \ud83d\udcc1 store/\n    \u2502               \u2514\u2500\u2500 \ud83d\udcc1 order/\n    \u251c\u2500\u2500 \ud83d\udcc4 Dockerfile\n    \u2514\u2500\u2500 \ud83d\udcc4 pom.xml\n</code></pre>"},{"location":"roteiro3/main/#repositorios","title":"Reposit\u00f3rios","text":"Componente Descri\u00e7\u00e3o Link do Reposit\u00f3rio Order API FeignClient para comunica\u00e7\u00e3o entre microservi\u00e7os [Link do reposit\u00f3rio] Order Service Servi\u00e7o principal com l\u00f3gica de neg\u00f3cios e persist\u00eancia [Link do reposit\u00f3rio] Product API Integra\u00e7\u00e3o para buscar informa\u00e7\u00f5es de produtos [Link do reposit\u00f3rio] Gateway API Gateway para roteamento de requisi\u00e7\u00f5es [Link do reposit\u00f3rio]"},{"location":"roteiro3/main/#tecnologias-utilizadas","title":"Tecnologias Utilizadas","text":""},{"location":"roteiro3/main/#order-api","title":"Order API","text":"<ul> <li>Spring Boot 3.5.5</li> <li>Java 21</li> <li>Spring Cloud OpenFeign 2025.0.0</li> <li>Lombok</li> <li>Product API (depend\u00eancia)</li> </ul>"},{"location":"roteiro3/main/#order-service","title":"Order Service","text":"<ul> <li>Spring Boot 3.5.5</li> <li>Java 21</li> <li>Spring Data JPA</li> <li>PostgreSQL 17.6</li> <li>Flyway (Database Migration)</li> <li>Spring Cloud OpenFeign</li> <li>Lombok</li> <li>Order API (depend\u00eancia)</li> <li>Product API (depend\u00eancia)</li> </ul>"},{"location":"roteiro3/main/#configuracao-e-execucao","title":"Configura\u00e7\u00e3o e Execu\u00e7\u00e3o","text":""},{"location":"roteiro3/main/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<ul> <li>Java 21+</li> <li>Maven 3.8+</li> <li>PostgreSQL 17.6+</li> <li>Product Service rodando (depend\u00eancia externa)</li> </ul>"},{"location":"roteiro3/main/#variaveis-de-ambiente-order-service","title":"Vari\u00e1veis de Ambiente (Order Service)","text":"<pre><code>DATABASE_URL=jdbc:postgresql://localhost:5432/store\nDATABASE_USERNAME=store\nDATABASE_PASSWORD=store\n</code></pre>"},{"location":"roteiro3/main/#executar-order-service","title":"Executar Order Service","text":"<pre><code>cd api/order_service\nmvn clean install\nmvn spring-boot:run\n</code></pre> <p>A aplica\u00e7\u00e3o estar\u00e1 dispon\u00edvel em: <code>http://localhost:8080</code></p>"},{"location":"roteiro3/main/#schema-do-banco-de-dados","title":"Schema do Banco de Dados","text":""},{"location":"roteiro3/main/#schema-orders","title":"Schema: <code>orders</code>","text":"<pre><code>CREATE SCHEMA IF NOT EXISTS orders;\n</code></pre>"},{"location":"roteiro3/main/#tabela-orders","title":"Tabela: <code>orders</code>","text":"<pre><code>CREATE TABLE orders.orders (\n    id_order VARCHAR(36) NOT NULL,\n    id_account VARCHAR(36) NOT NULL,\n    dt_created_at TIMESTAMP NOT NULL,\n    vl_total DOUBLE PRECISION NOT NULL,\n    CONSTRAINT pk_order PRIMARY KEY (id_order)\n);\n</code></pre> <p>Campos: - <code>id_order</code>: UUID do pedido (chave prim\u00e1ria) - <code>id_account</code>: UUID da conta do usu\u00e1rio - <code>dt_created_at</code>: Data e hora de cria\u00e7\u00e3o do pedido - <code>vl_total</code>: Valor total do pedido</p>"},{"location":"roteiro3/main/#tabela-order_item","title":"Tabela: <code>order_item</code>","text":"<pre><code>CREATE TABLE orders.order_item (\n    id_order_item VARCHAR(36) NOT NULL,\n    id_order VARCHAR(36) NOT NULL,\n    id_product VARCHAR(36) NOT NULL,\n    qt_quantity INTEGER NOT NULL,\n    vl_price DOUBLE PRECISION NOT NULL,\n    vl_subtotal DOUBLE PRECISION NOT NULL,\n    CONSTRAINT pk_order_item PRIMARY KEY (id_order_item),\n    CONSTRAINT fk_order_item_order FOREIGN KEY (id_order)\n        REFERENCES orders.orders(id_order) ON DELETE CASCADE\n);\n</code></pre> <p>Campos: - <code>id_order_item</code>: UUID do item (chave prim\u00e1ria) - <code>id_order</code>: UUID do pedido (chave estrangeira) - <code>id_product</code>: UUID do produto (refer\u00eancia ao Product Service) - <code>qt_quantity</code>: Quantidade do item - <code>vl_price</code>: Pre\u00e7o unit\u00e1rio no momento da compra - <code>vl_subtotal</code>: Subtotal do item (quantidade \u00d7 pre\u00e7o)</p> <p>Caracter\u00edsticas: - CASCADE DELETE: Ao deletar um pedido, todos os itens s\u00e3o deletados automaticamente - Relacionamento 1:N: Um pedido pode ter m\u00faltiplos itens</p>"},{"location":"roteiro3/main/#arquitetura","title":"Arquitetura","text":""},{"location":"roteiro3/main/#camadas-da-aplicacao","title":"Camadas da Aplica\u00e7\u00e3o","text":"<ol> <li>Controller Layer - <code>OrderResource</code>: Gerencia requisi\u00e7\u00f5es HTTP</li> <li>Service Layer - <code>OrderService</code>: Cont\u00e9m a l\u00f3gica de neg\u00f3cios</li> <li>Repository Layer - <code>OrderRepository</code>, <code>OrderItemRepository</code>: Acesso aos dados</li> <li>DTO Layer - <code>OrderIn/OrderOut</code>, <code>OrderItemIn/OrderItemOut</code>: Contratos da API</li> <li>Domain Model - <code>Order</code>, <code>OrderItem</code>: Representa as entidades de neg\u00f3cio</li> <li>Entity Model - <code>OrderModel</code>, <code>OrderItemModel</code>: Representa as entidades do banco</li> </ol>"},{"location":"roteiro3/main/#parserconverter-layer","title":"Parser/Converter Layer","text":"<p>OrderParser - Respons\u00e1vel por: - Converter <code>OrderIn</code> \u2192 <code>Order</code> (domain) - Converter <code>Order</code> \u2192 <code>OrderOut</code> (response) - Enriquecer items com dados do Product Service - Calcular subtotais e totais</p>"},{"location":"roteiro3/main/#comunicacao-entre-microservicos","title":"Comunica\u00e7\u00e3o entre Microservi\u00e7os","text":"<p>O Order Service integra-se com o Product Service para enriquecer os pedidos:</p> <pre><code>@FeignClient(name = \"product\", url = \"http://product-service:80\")\npublic interface ProductController {\n    @GetMapping(\"/product/{id}\")\n    ResponseEntity&lt;ProductOut&gt; findProduct(@PathVariable String id);\n}\n</code></pre> <p>Fluxo de Enriquecimento: 1. Cliente envia <code>OrderIn</code> com apenas <code>idProduct</code> e <code>quantity</code> 2. Order Service chama Product Service para cada produto 3. Obt\u00e9m <code>ProductOut</code> completo (nome, pre\u00e7o, unidade) 4. Calcula subtotal: <code>quantity \u00d7 product.price</code> 5. Calcula total do pedido: soma de todos os subtotais 6. Persiste no banco de dados 7. Retorna <code>OrderOut</code> enriquecido</p>"},{"location":"roteiro3/main/#multi-tenancy-baseado-em-headers","title":"Multi-Tenancy baseado em Headers","text":""},{"location":"roteiro3/main/#isolamento-de-dados-por-conta","title":"Isolamento de Dados por Conta","text":"<p>Todos os endpoints requerem o header <code>id-account</code> para garantir isolamento de dados:</p> <pre><code>@GetMapping(\"/order\")\npublic ResponseEntity&lt;List&lt;OrderOut&gt;&gt; findAll(\n    @RequestHeader(\"id-account\") String idAccount\n) {\n    // Retorna apenas pedidos da conta especificada\n}\n</code></pre> <p>Seguran\u00e7a: - Cada conta s\u00f3 pode ver seus pr\u00f3prios pedidos - Valida\u00e7\u00e3o do <code>id-account</code> em todas as opera\u00e7\u00f5es - Opera\u00e7\u00f5es de busca e delete verificam propriedade</p>"},{"location":"roteiro3/main/#integracoes","title":"Integra\u00e7\u00f5es","text":""},{"location":"roteiro3/main/#product-service","title":"Product Service","text":"<p>URL: <code>http://product-service:80</code></p> <p>Endpoint Utilizado: - <code>GET /product/{id}</code> - Buscar informa\u00e7\u00f5es de um produto</p> <p>Momento da Integra\u00e7\u00e3o: - Cria\u00e7\u00e3o de pedido: Busca produto para cada item - Listagem de pedidos: Busca produto para cada item (re-enriquecimento) - Busca de pedido por ID: Busca produto para cada item</p> <p>Dados Obtidos: </p><pre><code>{\n  \"id\": \"string\",\n  \"name\": \"string\",\n  \"price\": \"double\",\n  \"unit\": \"string\"\n}\n</code></pre><p></p> <p>Tratamento de Erros: - Se o produto n\u00e3o existir, o item n\u00e3o \u00e9 adicionado ao pedido - Logs de erro s\u00e3o registrados</p>"},{"location":"roteiro3/main/#calculo-automatico-de-valores","title":"C\u00e1lculo Autom\u00e1tico de Valores","text":""},{"location":"roteiro3/main/#subtotal-do-item","title":"Subtotal do Item","text":"<pre><code>subtotal = quantity \u00d7 product.price\n</code></pre> <p>Exemplo: - Quantidade: 5 - Pre\u00e7o unit\u00e1rio: R$ 8.90 - Subtotal: 5 \u00d7 8.90 = R$ 44.50</p>"},{"location":"roteiro3/main/#total-do-pedido","title":"Total do Pedido","text":"<pre><code>total = \u03a3(subtotal de todos os itens)\n</code></pre> <p>Exemplo: - Item 1: R$ 25.00 - Item 2: R$ 44.50 - Total: 25.00 + 44.50 = R$ 69.50</p>"},{"location":"roteiro3/main/#repositorios-personalizados","title":"Reposit\u00f3rios Personalizados","text":""},{"location":"roteiro3/main/#orderrepository","title":"OrderRepository","text":"<pre><code>public interface OrderRepository extends CrudRepository&lt;OrderModel, String&gt; {\n    List&lt;OrderModel&gt; findByIdAccount(String idAccount);\n    Optional&lt;OrderModel&gt; findByIdAndIdAccount(String id, String idAccount);\n}\n</code></pre> <p>M\u00e9todos: - <code>findByIdAccount</code>: Lista todos os pedidos de uma conta - <code>findByIdAndIdAccount</code>: Busca pedido validando propriedade</p>"},{"location":"roteiro3/main/#orderitemrepository","title":"OrderItemRepository","text":"<pre><code>public interface OrderItemRepository extends CrudRepository&lt;OrderItemModel, String&gt; {\n    List&lt;OrderItemModel&gt; findByIdOrder(String idOrder);\n    void deleteByIdOrder(String idOrder);\n}\n</code></pre> <p>M\u00e9todos: - <code>findByIdOrder</code>: Lista todos os itens de um pedido - <code>deleteByIdOrder</code>: Deleta todos os itens de um pedido</p>"},{"location":"roteiro3/main/#validacoes-e-tratamento-de-erros","title":"Valida\u00e7\u00f5es e Tratamento de Erros","text":""},{"location":"roteiro3/main/#validacoes-implementadas","title":"Valida\u00e7\u00f5es Implementadas","text":"<ol> <li>Account ID obrigat\u00f3rio: Header <code>id-account</code> deve estar presente</li> <li>Produto existe: Valida se o produto existe no Product Service</li> <li>Quantidade v\u00e1lida: Quantidade deve ser maior que zero</li> <li>Propriedade do pedido: Valida se o pedido pertence \u00e0 conta</li> </ol>"},{"location":"roteiro3/main/#tratamento-de-erros","title":"Tratamento de Erros","text":"Erro Status Code Descri\u00e7\u00e3o Pedido n\u00e3o encontrado 404 ID do pedido inv\u00e1lido ou n\u00e3o pertence \u00e0 conta Produto n\u00e3o encontrado 400/404 Produto referenciado n\u00e3o existe Account ID ausente 400 Header <code>id-account</code> n\u00e3o fornecido Erro de integra\u00e7\u00e3o 500 Falha ao comunicar com Product Service"},{"location":"roteiro3/main/#exemplos-de-uso","title":"Exemplos de Uso","text":""},{"location":"roteiro3/main/#criar-pedido-completo","title":"Criar Pedido Completo","text":"<p>Request: </p><pre><code>curl -X POST \"http://localhost:8080/order\" \\\n  -H \"Content-Type: application/json\" \\\n  -H \"id-account: 123e4567-e89b-12d3-a456-426614174000\" \\\n  -d '{\n    \"items\": [\n      {\n        \"idProduct\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"quantity\": 3\n      },\n      {\n        \"idProduct\": \"660e8400-e29b-41d4-a716-446655440001\",\n        \"quantity\": 2\n      }\n    ]\n  }'\n</code></pre><p></p> <p>Response: </p><pre><code>{\n  \"id\": \"770e8400-e29b-41d4-a716-446655440002\",\n  \"idAccount\": \"123e4567-e89b-12d3-a456-426614174000\",\n  \"date\": \"2025-10-31T14:30:45\",\n  \"items\": [\n    {\n      \"id\": \"880e8400-e29b-41d4-a716-446655440003\",\n      \"product\": {\n        \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"name\": \"Arroz Integral\",\n        \"price\": 12.50,\n        \"unit\": \"kg\"\n      },\n      \"quantity\": 3,\n      \"subtotal\": 37.50\n    },\n    {\n      \"id\": \"990e8400-e29b-41d4-a716-446655440004\",\n      \"product\": {\n        \"id\": \"660e8400-e29b-41d4-a716-446655440001\",\n        \"name\": \"Feij\u00e3o Preto\",\n        \"price\": 8.90,\n        \"unit\": \"kg\"\n      },\n      \"quantity\": 2,\n      \"subtotal\": 17.80\n    }\n  ],\n  \"total\": 55.30\n}\n</code></pre><p></p>"},{"location":"roteiro3/main/#logging","title":"Logging","text":"<p>A aplica\u00e7\u00e3o utiliza logging em n\u00edvel DEBUG para o pacote <code>store</code>:</p> <pre><code>logging:\n  level:\n    store: debug\n</code></pre> <p>Eventos logados: - Requisi\u00e7\u00f5es HTTP recebidas - Chamadas ao Product Service - Opera\u00e7\u00f5es de banco de dados - Erros e exce\u00e7\u00f5es - C\u00e1lculos de totais</p>"},{"location":"roteiro3/main/#dockerfile","title":"Dockerfile","text":"<pre><code>FROM openjdk:25-slim\nVOLUME /tmp\nCOPY target/*.jar /app.jar\nENTRYPOINT [\"java\",\"-jar\",\"/app.jar\"]\n</code></pre> <p>Build e Run: </p><pre><code>cd api/order_service\nmvn clean package\ndocker build -t order-service .\ndocker run -p 8080:8080 \\\n  -e DATABASE_URL=jdbc:postgresql://host:5432/store \\\n  -e DATABASE_USERNAME=store \\\n  -e DATABASE_PASSWORD=store \\\n  order-service\n</code></pre><p></p>"},{"location":"roteiro3/main/#recursos-avancados","title":"Recursos Avan\u00e7ados","text":""},{"location":"roteiro3/main/#1-transacoes","title":"1. Transa\u00e7\u00f5es","text":"<p>Opera\u00e7\u00f5es de cria\u00e7\u00e3o e dele\u00e7\u00e3o s\u00e3o transacionais:</p> <pre><code>@Service\n@Transactional\npublic class OrderService {\n    // M\u00e9todos transacionais\n}\n</code></pre>"},{"location":"roteiro3/main/#2-uuid-generation","title":"2. UUID Generation","text":"<p>IDs s\u00e3o gerados automaticamente usando UUID:</p> <pre><code>@Id\n@GeneratedValue(strategy = GenerationType.UUID)\nprivate String id;\n</code></pre>"},{"location":"roteiro3/main/#3-cascade-delete","title":"3. Cascade Delete","text":"<p>Dele\u00e7\u00e3o em cascata de itens ao deletar pedido:</p> <pre><code>CONSTRAINT fk_order_item_order FOREIGN KEY (id_order)\n    REFERENCES orders(id_order) ON DELETE CASCADE\n</code></pre>"},{"location":"roteiro3/main/#4-timestamp-automatico","title":"4. Timestamp Autom\u00e1tico","text":"<p>Data de cria\u00e7\u00e3o definida automaticamente:</p> <pre><code>private LocalDateTime createdAt = LocalDateTime.now();\n</code></pre>"},{"location":"roteiro3/main/#testes","title":"Testes","text":""},{"location":"roteiro3/main/#executar-testes","title":"Executar Testes","text":"<pre><code>cd api/order_service\nmvn test\n</code></pre>"},{"location":"roteiro3/main/#licenca","title":"Licen\u00e7a","text":"<p>[Adicione informa\u00e7\u00f5es sobre a licen\u00e7a do projeto]</p>"},{"location":"roteiro3/main/#contato","title":"Contato","text":"<p>[Adicione informa\u00e7\u00f5es de contato ou contribui\u00e7\u00e3o]</p>"},{"location":"roteiro4/main/","title":"Roteiro 4","text":""},{"location":"roteiro4/main/#jenkins-cicd-documentacao","title":"Jenkins CI/CD - Documenta\u00e7\u00e3o","text":""},{"location":"roteiro4/main/#visao-geral","title":"Vis\u00e3o Geral","text":"<p>O Jenkins \u00e9 a plataforma de CI/CD (Continuous Integration/Continuous Deployment) utilizada neste projeto para automatizar o processo de build, teste e deploy dos microservi\u00e7os. A configura\u00e7\u00e3o implementa pipelines declarativos para 10 componentes da aplica\u00e7\u00e3o (4 APIs de interface e 6 servi\u00e7os), incluindo build de depend\u00eancias, compila\u00e7\u00e3o Maven, cria\u00e7\u00e3o de imagens Docker multi-plataforma (linux/amd64 e linux/arm64) e push autom\u00e1tico para o Docker Hub. O Jenkins est\u00e1 containerizado com Docker Compose, inclui ferramentas como Maven, Docker CE e kubectl v1.30, e gerencia credenciais criptografadas para integra\u00e7\u00e3o segura com o Docker Hub.</p>"},{"location":"roteiro4/main/#estrutura-do-projeto-jenkins","title":"Estrutura do Projeto Jenkins","text":"<pre><code>\ud83d\udcc1 jenkins/\n\u251c\u2500\u2500 \ud83d\udcc4 compose.yaml\n\u2514\u2500\u2500 \ud83d\udcc1 config/\n    \u2514\u2500\u2500 \ud83d\udcc1 jenkins/\n        \u251c\u2500\u2500 \ud83d\udcc4 config.xml\n        \u251c\u2500\u2500 \ud83d\udcc4 credentials.xml\n        \u251c\u2500\u2500 \ud83d\udcc1 jobs/\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 account/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 accountservice/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 auth/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 auth-service/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 exchange/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 gateway/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 order/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 order-service/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u251c\u2500\u2500 \ud83d\udcc1 product/\n        \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2502   \u2514\u2500\u2500 \ud83d\udcc1 product-service/\n        \u2502       \u2514\u2500\u2500 \ud83d\udcc4 config.xml\n        \u2514\u2500\u2500 \ud83d\udcc1 plugins/\n</code></pre>"},{"location":"roteiro4/main/#pipelines-configurados","title":"Pipelines Configurados","text":""},{"location":"roteiro4/main/#apis-de-interface-libraries","title":"APIs de Interface (Libraries)","text":"<p>Estes jobs compilam as bibliotecas compartilhadas que ser\u00e3o usadas como depend\u00eancias pelos servi\u00e7os.</p>"},{"location":"roteiro4/main/#1-account-api","title":"1. Account API","text":"<p>Jenkinsfile: <code>api/account/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean install'\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Compila a biblioteca Account API - Instala no reposit\u00f3rio Maven local - Pula testes para acelerar o build - Ser\u00e1 usada como depend\u00eancia pelo Account Service</p>"},{"location":"roteiro4/main/#2-auth-api","title":"2. Auth API","text":"<p>Jenkinsfile: <code>api/auth/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean install'\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Compila a biblioteca Auth API - Instala no reposit\u00f3rio Maven local - Ser\u00e1 usada como depend\u00eancia pelo Auth Service</p>"},{"location":"roteiro4/main/#3-product-api","title":"3. Product API","text":"<p>Jenkinsfile: <code>api/product/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean install'\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Compila a biblioteca Product API (FeignClient) - Instala no reposit\u00f3rio Maven local - Ser\u00e1 usada como depend\u00eancia pelo Product Service e Order Service</p>"},{"location":"roteiro4/main/#4-order-api","title":"4. Order API","text":"<p>Jenkinsfile: <code>api/order/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean install'\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Compila a biblioteca Order API (FeignClient) - Instala no reposit\u00f3rio Maven local - Ser\u00e1 usada como depend\u00eancia pelo Order Service</p>"},{"location":"roteiro4/main/#servicos-com-docker-services","title":"Servi\u00e7os com Docker (Services)","text":"<p>Estes jobs compilam os servi\u00e7os, criam imagens Docker multi-plataforma e fazem push para o Docker Hub.</p>"},{"location":"roteiro4/main/#5-product-service","title":"5. Product Service","text":"<p>Jenkinsfile: <code>api/product_service/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'product'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Dependencies') {\n            steps {\n                build job: 'product', wait: true\n            }\n        }\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Stage 1 - Dependencies: Executa o build do job 'product' (API) e aguarda conclus\u00e3o - Stage 2 - Build: Compila o servi\u00e7o com Maven (pula testes) - Stage 3 - Build &amp; Push Image:   - Login no Docker Hub com credenciais seguras   - Cria builder multi-plataforma (ARM64 + AMD64)   - Gera imagem Docker para ambas as arquiteturas   - Push para Docker Hub com tags <code>:latest</code> e <code>:BUILD_ID</code>   - Remove o builder tempor\u00e1rio</p> <p>Docker Hub: <code>deenaelorra/product:latest</code> e <code>deenaelorra/product:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#6-order-service","title":"6. Order Service","text":"<p>Jenkinsfile: <code>api/order_service/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'order'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Dependencies') {\n            steps {\n                build job: 'product', wait: true\n                build job: 'order', wait: true\n            }\n        }\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Dependencies: Compila 'product' e 'order' APIs sequencialmente - Build: Compila o Order Service - Build &amp; Push Image: Gera e publica imagem Docker multi-plataforma</p> <p>Docker Hub: <code>deenaelorra/order:latest</code> e <code>deenaelorra/order:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#7-account-service","title":"7. Account Service","text":"<p>Jenkinsfile: <code>api/accountservice/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'accountservice'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Dependencies') {\n            steps {\n                build job: 'account', wait: true\n            }\n        }\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Docker Hub: <code>deenaelorra/accountservice:latest</code> e <code>deenaelorra/accountservice:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#8-auth-service","title":"8. Auth Service","text":"<p>Jenkinsfile: <code>api/auth_service/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'auth-service'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Dependencies') {\n            steps {\n                build job: 'account', wait: true\n                build job: 'auth', wait: true\n            }\n        }\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Docker Hub: <code>deenaelorra/auth-service:latest</code> e <code>deenaelorra/auth-service:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#9-gateway-service","title":"9. Gateway Service","text":"<p>Jenkinsfile: <code>api/gateway-service/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'gateway'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Build') {\n            steps {\n                sh 'mvn -B -DskipTests clean package'\n            }\n        }\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Sem Dependencies: Gateway n\u00e3o depende de outras APIs - Compila e gera imagem Docker multi-plataforma</p> <p>Docker Hub: <code>deenaelorra/gateway:latest</code> e <code>deenaelorra/gateway:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#10-exchange-service-python","title":"10. Exchange Service (Python)","text":"<p>Jenkinsfile: <code>api/exchange/Jenkinsfile</code></p> <pre><code>pipeline {\n    agent any\n    environment {\n        SERVICE = 'exchange'\n        NAME = \"deenaelorra/${env.SERVICE}\"\n    }\n    stages {\n        stage('Build &amp; Push Image') {\n            steps {\n                withCredentials([usernamePassword(\n                    credentialsId: 'dockerhub-credential',\n                    usernameVariable: 'USERNAME',\n                    passwordVariable: 'TOKEN')])\n                {\n                    sh \"docker login -u $USERNAME -p $TOKEN\"\n                    sh \"docker buildx create --use --platform=linux/arm64,linux/amd64 --node multi-platform-builder-${env.SERVICE} --name multi-platform-builder-${env.SERVICE}\"\n                    sh \"docker buildx build --platform=linux/arm64,linux/amd64 --push --tag ${env.NAME}:latest --tag ${env.NAME}:${env.BUILD_ID} -f Dockerfile .\"\n                    sh \"docker buildx rm --force multi-platform-builder-${env.SERVICE}\"\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Funcionalidade: - Sem Maven Build: Aplica\u00e7\u00e3o Python/FastAPI n\u00e3o requer compila\u00e7\u00e3o Java - Apenas cria e publica imagem Docker multi-plataforma</p> <p>Docker Hub: <code>deenaelorra/exchange:latest</code> e <code>deenaelorra/exchange:{BUILD_ID}</code></p>"},{"location":"roteiro4/main/#grafo-de-dependencias","title":"Grafo de Depend\u00eancias","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    JENKINS PIPELINE                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  account API \u2502 \u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n                     \u251c\u2500\u2500&gt; \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                     \u2502    \u2502 accountservice   \u2502 \u2500\u2500&gt; Docker Hub\n                     \u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502   auth API   \u2502 \u2500\u2500\u2500\u2500\u2524\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502\n                     \u2514\u2500\u2500&gt; \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502  auth-service    \u2502 \u2500\u2500&gt; Docker Hub\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 product API  \u2502 \u2500\u2500\u2500\u2500\u252c\u2500\u2500&gt; \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2502    \u2502 product-service  \u2502 \u2500\u2500&gt; Docker Hub\n                     \u2502    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u2502\n\u2502  order API   \u2502 \u2500\u2500\u2500\u2500\u2534\u2500\u2500&gt; \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518          \u2502  order-service   \u2502 \u2500\u2500&gt; Docker Hub\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502     gateway      \u2502 \u2500\u2500&gt; Docker Hub\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n                          \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                          \u2502    exchange      \u2502 \u2500\u2500&gt; Docker Hub\n                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"roteiro4/main/#configuracao-do-jenkins-com-docker-compose","title":"Configura\u00e7\u00e3o do Jenkins com Docker Compose","text":""},{"location":"roteiro4/main/#arquivo-jenkinscomposeyaml","title":"Arquivo: <code>jenkins/compose.yaml</code>","text":"<pre><code># docker compose up -d --build --force-recreate\nname: ops\n\nservices:\n\n  jenkins:\n    container_name: jenkins\n    build:\n      dockerfile_inline: |\n        FROM jenkins/jenkins:jdk21\n        USER root\n\n        # Install tools\n        RUN apt-get update &amp;&amp; apt-get install -y lsb-release iputils-ping maven\n\n        # Install Docker\n        RUN curl -fsSLo /usr/share/keyrings/docker-archive-keyring.asc \\\n          https://download.docker.com/linux/debian/gpg\n        RUN echo \"deb [arch=$(dpkg --print-architecture) \\\n          signed-by=/usr/share/keyrings/docker-archive-keyring.asc] \\\n          https://download.docker.com/linux/debian \\\n          $(lsb_release -cs) stable\" &gt; /etc/apt/sources.list.d/docker.list\n        RUN apt-get update &amp;&amp; apt-get install -y docker-ce\n\n        # Install kubectl\n        RUN apt-get install -y apt-transport-https ca-certificates curl\n        RUN curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key | gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg\n        RUN chmod 644 /etc/apt/keyrings/kubernetes-apt-keyring.gpg\n        RUN echo 'deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] https://pkgs.k8s.io/core:/stable:/v1.30/deb/ /' | tee /etc/apt/sources.list.d/kubernetes.list\n        RUN chmod 644 /etc/apt/sources.list.d/kubernetes.list\n        RUN apt-get update &amp;&amp; apt-get install -y kubectl\n\n        RUN usermod -aG docker jenkins\n    ports:\n      - 9080:8080\n    volumes:\n      - ${CONFIG:-./config}/jenkins:/var/jenkins_home\n      - /var/run/docker.sock:/var/run/docker.sock\n    restart: always\n</code></pre> <p>Caracter\u00edsticas: - Imagem Base: jenkins/jenkins:jdk21 - Porta: 9080 (host) \u2192 8080 (container) - Ferramentas Instaladas:   - Maven (builds Java)   - Docker CE (builds de imagens)   - kubectl v1.30 (deploy Kubernetes) - Volumes:   - <code>/var/jenkins_home</code> - Dados persistentes do Jenkins   - <code>/var/run/docker.sock</code> - Socket Docker (Docker-in-Docker) - Restart Policy: always</p>"},{"location":"roteiro4/main/#executar-jenkins","title":"Executar Jenkins","text":"<pre><code>cd jenkins\ndocker compose up -d --build --force-recreate\n</code></pre> <p>Acesse: <code>http://localhost:9080</code></p>"},{"location":"roteiro4/main/#screenshots-do-jenkins","title":"Screenshots do Jenkins","text":""},{"location":"roteiro4/main/#dashboard-principal","title":"Dashboard Principal","text":""},{"location":"roteiro4/main/#lista-de-jobspipelines","title":"Lista de Jobs/Pipelines","text":""},{"location":"roteiro4/main/#pipeline-em-execucao","title":"Pipeline em Execu\u00e7\u00e3o","text":""},{"location":"roteiro4/main/#build-concluido-com-sucesso","title":"Build Conclu\u00eddo com Sucesso","text":""},{"location":"roteiro4/main/#credenciais-do-docker-hub","title":"Credenciais do Docker Hub","text":""},{"location":"roteiro4/main/#configuracao-no-jenkins","title":"Configura\u00e7\u00e3o no Jenkins","text":"<p>As credenciais do Docker Hub s\u00e3o armazenadas de forma segura no Jenkins:</p> <p>Credential ID: <code>dockerhub-credential</code></p> <p>Tipo: Username with password</p> <p>Campos: - Username: deenaelorra - Password: [Criptografado]</p>"},{"location":"roteiro4/main/#screenshot-da-configuracao","title":"Screenshot da Configura\u00e7\u00e3o","text":""},{"location":"roteiro4/main/#como-adicionar-credenciais","title":"Como Adicionar Credenciais","text":"<ol> <li>Acesse Jenkins \u2192 Manage Jenkins \u2192 Credentials</li> <li>Clique em \"(global)\" domain</li> <li>Add Credentials</li> <li>Preencha:</li> <li>Kind: Username with password</li> <li>Scope: Global</li> <li>Username: deenaelorra</li> <li>Password: [sua senha do Docker Hub]</li> <li>ID: dockerhub-credential</li> <li>Description: Docker Hub Credentials</li> <li>Salvar</li> </ol>"},{"location":"roteiro4/main/#imagens-docker-publicadas","title":"Imagens Docker Publicadas","text":"<p>Todas as imagens s\u00e3o publicadas no Docker Hub com duas tags:</p> Servi\u00e7o Reposit\u00f3rio Docker Hub Tags Product Service <code>deenaelorra/product</code> <code>:latest</code>, <code>:{BUILD_ID}</code> Order Service <code>deenaelorra/order</code> <code>:latest</code>, <code>:{BUILD_ID}</code> Account Service <code>deenaelorra/accountservice</code> <code>:latest</code>, <code>:{BUILD_ID}</code> Auth Service <code>deenaelorra/auth-service</code> <code>:latest</code>, <code>:{BUILD_ID}</code> Gateway <code>deenaelorra/gateway</code> <code>:latest</code>, <code>:{BUILD_ID}</code> Exchange <code>deenaelorra/exchange</code> <code>:latest</code>, <code>:{BUILD_ID}</code> <p>Plataformas Suportadas: - linux/amd64 (x86-64) - linux/arm64 (ARM64)</p>"},{"location":"roteiro4/main/#build-multi-plataforma-com-docker-buildx","title":"Build Multi-Plataforma com Docker Buildx","text":""},{"location":"roteiro4/main/#comandos-utilizados","title":"Comandos Utilizados","text":"<pre><code># 1. Login no Docker Hub\ndocker login -u $USERNAME -p $TOKEN\n\n# 2. Criar builder multi-plataforma\ndocker buildx create --use \\\n  --platform=linux/arm64,linux/amd64 \\\n  --node multi-platform-builder-{SERVICE} \\\n  --name multi-platform-builder-{SERVICE}\n\n# 3. Build e push para ambas as plataformas\ndocker buildx build \\\n  --platform=linux/arm64,linux/amd64 \\\n  --push \\\n  --tag deenaelorra/{SERVICE}:latest \\\n  --tag deenaelorra/{SERVICE}:{BUILD_ID} \\\n  -f Dockerfile .\n\n# 4. Remover builder tempor\u00e1rio\ndocker buildx rm --force multi-platform-builder-{SERVICE}\n</code></pre> <p>Benef\u00edcios: - Imagens funcionam em servidores AMD64 (Intel/AMD) - Imagens funcionam em Apple Silicon (M1/M2/M3) - Compatibilidade com ARM servers (AWS Graviton, etc.)</p>"},{"location":"roteiro4/main/#fluxo-de-cicd","title":"Fluxo de CI/CD","text":""},{"location":"roteiro4/main/#1-commit-no-git","title":"1. Commit no Git","text":"<pre><code>Developer \u2192 git push \u2192 GitHub\n</code></pre>"},{"location":"roteiro4/main/#2-trigger-do-jenkins","title":"2. Trigger do Jenkins","text":"<pre><code>GitHub Webhook \u2192 Jenkins \u2192 Start Pipeline\n</code></pre>"},{"location":"roteiro4/main/#3-execucao-da-pipeline","title":"3. Execu\u00e7\u00e3o da Pipeline","text":"<p>Para Libraries (account, auth, product, order): </p><pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Stage: Build   \u2502\n\u2502   mvn install    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         v\n    [Success]\n</code></pre><p></p> <p>Para Services (product-service, order-service, etc.): </p><pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage: Dependencies  \u2502\n\u2502  Build lib jobs      \u2502\n\u2502    (wait: true)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Stage: Build       \u2502\n\u2502  mvn package         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         v\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Stage: Build &amp; Push  \u2502\n\u2502  - Docker login      \u2502\n\u2502  - buildx create     \u2502\n\u2502  - buildx build      \u2502\n\u2502  - Push to Hub       \u2502\n\u2502  - buildx rm         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         v\n   [Docker Hub]\n</code></pre><p></p>"},{"location":"roteiro4/main/#4-deploy-manual-ou-automatico","title":"4. Deploy (Manual ou Autom\u00e1tico)","text":"<pre><code>Docker Hub \u2192 kubectl apply \u2192 Kubernetes Cluster\n</code></pre>"},{"location":"roteiro4/main/#jobs-configurados","title":"Jobs Configurados","text":""},{"location":"roteiro4/main/#resumo-de-todos-os-jobs","title":"Resumo de Todos os Jobs","text":"Job Name Tipo Depend\u00eancias Docker Image Plataformas account Library - - - accountservice Service account deenaelorra/accountservice amd64, arm64 auth Library - - - auth-service Service account, auth deenaelorra/auth-service amd64, arm64 product Library - - - product-service Service product deenaelorra/product amd64, arm64 order Library - - - order-service Service product, order deenaelorra/order amd64, arm64 gateway Service - deenaelorra/gateway amd64, arm64 exchange Service - deenaelorra/exchange amd64, arm64"},{"location":"roteiro4/main/#configuracao-de-seguranca","title":"Configura\u00e7\u00e3o de Seguran\u00e7a","text":""},{"location":"roteiro4/main/#autenticacao-e-autorizacao","title":"Autentica\u00e7\u00e3o e Autoriza\u00e7\u00e3o","text":"<p>Arquivo: <code>jenkins/config/jenkins/config.xml</code></p> <pre><code>&lt;authorizationStrategy class=\"hudson.security.FullControlOnceLoggedInAuthorizationStrategy\"&gt;\n  &lt;denyAnonymousReadAccess&gt;true&lt;/denyAnonymousReadAccess&gt;\n&lt;/authorizationStrategy&gt;\n</code></pre> <p>Caracter\u00edsticas: - Acesso an\u00f4nimo negado - Usu\u00e1rios autenticados t\u00eam controle total - CSRF protection habilitado</p>"},{"location":"roteiro4/main/#credenciais-criptografadas","title":"Credenciais Criptografadas","text":"<p>Arquivo: <code>jenkins/config/jenkins/credentials.xml</code></p> <p>As credenciais s\u00e3o armazenadas com criptografia AES: - Username: plain text - Password: criptografado com secret key do Jenkins - Secret key: armazenado em <code>jenkins/config/jenkins/secrets/</code></p>"},{"location":"roteiro4/main/#comandos-uteis","title":"Comandos \u00dateis","text":""},{"location":"roteiro4/main/#gerenciar-jenkins-container","title":"Gerenciar Jenkins Container","text":"<pre><code># Iniciar Jenkins\ncd jenkins\ndocker compose up -d\n\n# Ver logs\ndocker compose logs -f jenkins\n\n# Parar Jenkins\ndocker compose down\n\n# Rebuild completo\ndocker compose up -d --build --force-recreate\n\n# Entrar no container\ndocker exec -it jenkins bash\n</code></pre>"},{"location":"roteiro4/main/#gerenciar-builds","title":"Gerenciar Builds","text":"<pre><code># Trigger manual de build (via CLI)\njava -jar jenkins-cli.jar -s http://localhost:9080/ build product-service\n\n# Ver status do \u00faltimo build\njava -jar jenkins-cli.jar -s http://localhost:9080/ get-job product-service\n</code></pre>"},{"location":"roteiro4/main/#docker-hub","title":"Docker Hub","text":"<pre><code># Pull de uma imagem\ndocker pull deenaelorra/product:latest\n\n# Ver tags dispon\u00edveis\ncurl -L -s 'https://registry.hub.docker.com/v2/repositories/deenaelorra/product/tags?page_size=100' | jq -r '.results[].name'\n\n# Run local\ndocker run -p 8080:8080 deenaelorra/product:latest\n</code></pre>"},{"location":"roteiro4/main/#troubleshooting","title":"Troubleshooting","text":""},{"location":"roteiro4/main/#problema-build-falha-por-falta-de-dependencia","title":"Problema: Build falha por falta de depend\u00eancia","text":"<p>Solu\u00e7\u00e3o: Certifique-se de que os jobs das libraries foram executados primeiro: </p><pre><code># Ordem correta:\n1. account \u2192 accountservice\n2. auth \u2192 auth-service\n3. product \u2192 product-service\n4. product + order \u2192 order-service\n</code></pre><p></p>"},{"location":"roteiro4/main/#problema-docker-hub-push-falha","title":"Problema: Docker Hub push falha","text":"<p>Solu\u00e7\u00e3o: Verifique as credenciais: 1. Jenkins \u2192 Manage Jenkins \u2192 Credentials 2. Verifique se <code>dockerhub-credential</code> existe 3. Teste login manual: <code>docker login -u deenaelorra</code></p>"},{"location":"roteiro4/main/#problema-multi-platform-build-falha","title":"Problema: Multi-platform build falha","text":"<p>Solu\u00e7\u00e3o: Verifique se buildx est\u00e1 instalado: </p><pre><code>docker exec -it jenkins bash\ndocker buildx version\n</code></pre><p></p>"},{"location":"roteiro4/main/#problema-permissao-negada-ao-acessar-docker","title":"Problema: Permiss\u00e3o negada ao acessar Docker","text":"<p>Solu\u00e7\u00e3o: Verifique se Jenkins est\u00e1 no grupo docker: </p><pre><code>docker exec -it jenkins bash\ngroups jenkins  # deve incluir 'docker'\n</code></pre><p></p>"},{"location":"roteiro4/main/#melhorias-futuras","title":"Melhorias Futuras","text":"<ol> <li>Testes Automatizados: Adicionar stage de testes (<code>mvn test</code>)</li> <li>SonarQube: Integra\u00e7\u00e3o para an\u00e1lise de c\u00f3digo</li> <li>Notifica\u00e7\u00f5es: Slack/Email para builds falhados</li> <li>Deploy Autom\u00e1tico: kubectl apply ap\u00f3s push bem-sucedido</li> <li>Rollback: Pipeline de rollback para vers\u00f5es anteriores</li> <li>Cache de Depend\u00eancias: Melhorar performance com cache Maven</li> </ol>"},{"location":"roteiro4/main/#tecnologias-utilizadas","title":"Tecnologias Utilizadas","text":"<ul> <li>Jenkins 2.533 - Servidor CI/CD</li> <li>JDK 21 - Ambiente Java</li> <li>Maven - Build tool para Java</li> <li>Docker CE - Containeriza\u00e7\u00e3o</li> <li>Docker Buildx - Builds multi-plataforma</li> <li>kubectl v1.30 - Deploy Kubernetes</li> <li>Git - Controle de vers\u00e3o</li> <li>Docker Hub - Registry de imagens</li> </ul>"},{"location":"roteiro4/main/#repositorios","title":"Reposit\u00f3rios","text":"Componente Descri\u00e7\u00e3o Link do Reposit\u00f3rio Jenkins Config Configura\u00e7\u00f5es e pipelines do Jenkins [Link do reposit\u00f3rio] Docker Hub Registry com todas as imagens https://hub.docker.com/u/deenaelorra"},{"location":"roteiro4/main/#licenca","title":"Licen\u00e7a","text":"<p>[Adicione informa\u00e7\u00f5es sobre a licen\u00e7a do projeto]</p>"},{"location":"roteiro4/main/#contato","title":"Contato","text":"<p>[Adicione informa\u00e7\u00f5es de contato ou contribui\u00e7\u00e3o]</p>"},{"location":"thisdocumentation/main/","title":"This documentation","text":""},{"location":"thisdocumentation/main/#this-documentation","title":"This documentation","text":""},{"location":"thisdocumentation/main/#pre-requisitos","title":"Pr\u00e9-requisitos","text":"<p>Antes de come\u00e7ar, certifique-se de que voc\u00ea possui os seguintes pr\u00e9-requisitos instalados em seu sistema:</p> <ul> <li>Git: Para clonar o reposit\u00f3rio.</li> </ul>"},{"location":"thisdocumentation/main/#instalando-o-python","title":"Instalando o Python","text":"LinuxmacOSWindows <p>Instale o Python 3.8 ou superior.</p> <pre><code>sudo apt install python3 python3-venv python3-pip\npython3 --version\n</code></pre> <p>Instale o Python 3.8 ou superior.</p> <pre><code>brew install python\npython3 --version\n</code></pre> <p>Instale o Python 3.13 ou superior. Baixe o instalador do site oficial do Python (https://www.python.org/downloads/) e execute-o. Certifique-se de marcar a op\u00e7\u00e3o \"Add Python to PATH\" durante a instala\u00e7\u00e3o.</p> <pre><code>python --version\n</code></pre>"},{"location":"thisdocumentation/main/#usage","title":"Usage","text":"<p>Para utilizar o c\u00f3digo deste reposit\u00f3rio, siga as instru\u00e7\u00f5es a seguir:</p> <p>Clone ou fork este reposit\u00f3rio:</p> <pre><code>git clone &lt;URL_DO_REPOSITORIO&gt;\n</code></pre> <p>Crie um ambiente virtual do Python:</p> Linux/macOSWindows <pre><code>python3 -m venv env\n</code></pre> <pre><code>python -m venv env\n</code></pre> <p>Ative o ambiente virtual (voc\u00ea deve fazer isso sempre que for executar algum script deste reposit\u00f3rio):</p> Linux/macOSWindows <pre><code>source ./env/bin/activate\n</code></pre> <pre><code>.\\env\\Scripts\\activate\n</code></pre> <p>Instale as depend\u00eancias com:</p> Linux/macOSWindows <pre><code>python3 -m pip install -r requirements.txt --upgrade\n</code></pre> <pre><code>python -m pip install -r requirements.txt --upgrade\n</code></pre>"},{"location":"thisdocumentation/main/#deployment","title":"Deployment","text":"<p>O material utiliza o mkdocs para gerar a documenta\u00e7\u00e3o. Para visualizar a documenta\u00e7\u00e3o, execute o comando:</p> <pre><code>mkdocs serve -o\n</code></pre> <p>Para subir ao GitHub Pages, execute o comando:</p> <pre><code>mkdocs gh-deploy\n</code></pre> <p>Esse reposit\u00f3rio possui um workflow do GitHub Actions que executa o comando <code>mkdocs gh-deploy</code> sempre que houver um push na branch <code>main</code>. Assim, n\u00e3o \u00e9 necess\u00e1rio executar esse comando manualmente. Toda vez que voc\u00ea fizer um push na branch <code>main</code>, a documenta\u00e7\u00e3o ser\u00e1 atualizada automaticamente no GitHub Pages.</p> <p>Aviso 1</p> <p>Para que o github actions funcione corretamente, \u00e9 necess\u00e1rio que o reposit\u00f3rio esteja configurado para que o bot <code>github-actions[bot]</code> tenha permiss\u00e3o de escrita. Voc\u00ea pode verificar isso nas configura\u00e7\u00f5es do reposit\u00f3rio, na se\u00e7\u00e3o \"Actions\" e depois em \"General\". Certifique-se de que a op\u00e7\u00e3o \"Workflow permissions\" esteja definida como \"Read and write permissions\".</p> <p></p> <p>Aviso 2</p> <p>Depois de publicar, caso n\u00e3o consiga acessar a p\u00e1gina, verifique se o github pages est\u00e1 configurado corretamente. V\u00e1 at\u00e9 as configura\u00e7\u00f5es do reposit\u00f3rio, na se\u00e7\u00e3o \"Pages\" e verifique se a branch <code>gh-pages</code> est\u00e1 selecionada como fonte. Se n\u00e3o estiver, selecione-a e salve as altera\u00e7\u00f5es.</p> <p></p> <p>Pay Attention</p> <p>No arquivo '<code>mkdocs.yml</code>, a se\u00e7\u00e3o <code>site_url</code> deve estar configurada corretamente para o seu reposit\u00f3rio. Por exemplo, se o seu reposit\u00f3rio estiver em <code>https://github.com/usuario/repositorio</code>, a se\u00e7\u00e3o <code>site_url</code> deve ser:</p> <pre><code>site_url: https://usuario.github.io/repositorio\n</code></pre> <p>Tamb\u00e9m, certifique-se de que a se\u00e7\u00e3o <code>repo_url</code> esteja configurada corretamente para o seu reposit\u00f3rio. Por exemplo:</p> <pre><code>repo_url: https://github.com/usuario/repositorio\n</code></pre>"}]}